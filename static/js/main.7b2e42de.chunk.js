(this.webpackJsonpelectricad=this.webpackJsonpelectricad||[]).push([[0],{64:function(e,t,n){e.exports=n(77)},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(8),i=n.n(r),c=(n(69),n(7)),l=n(4),s=Object(a.createContext)(null);function u(e){var t=e.width,n=e.height,r=Object(a.useContext)(s),i=r.__selectedRoom,u=r.__rooms,d=Object(l.a)(u,2),m=d[0],p=d[1],f=i[1],b=function(e){var a=window.prompt("D\xe9nomination de la pi\xe8ce");if(""!==a&&null!==a)if(m.find((function(e){return e.id===a})))alert("Une pi\xe8ce nomm\xe9e ".concat(a," existe d\xe9j\xe0. Cr\xe9ation annul\xe9e !!!"));else{var o={id:a,x:e.clientX?e.clientX-75:t/2,y:e.clientY?e.clientY-75:n/2,points:[{x:0,y:0},{x:0,y:200},{x:200,y:200},{x:200,y:0}],getPoints:function(){var e=this;return this.points.reduce((function(t,n,o){return t[o]={x:n.x,y:n.y,absX:n.x+e.x,absY:n.y+e.y,offsetX:e.x,offsetY:e.y,i:o,room:a,id:"".concat(e.id,".").concat(o)},t}),[])},doors:[],outlets:[],switches:[],lamps:[],components:[]};p([].concat(Object(c.a)(m),[o])),f(o.id)}};return o.a.createElement("rect",{style:{outline:"none"},tabIndex:-1,id:"background",width:t,height:n,fill:"#38a0f9",onDoubleClick:b,onClick:function(){return f(null)},onKeyDown:function(e){78===e.keyCode&&b(e)}})}var d=n(15);function m(e){return e.reduce((function(t,n,a){return t[a]=[n],a>0&&t[a-1].push(n),a===e.length-1&&t[a].push(t[0][0]),t}),[])}function p(e){return e.reduce((function(e,t,n){var a=t.getPoints();return e.push.apply(e,Object(c.a)(a)),e}),[])}var f=function(e,t){var n=Object(l.a)(t,2),a=n[0],o=n[1],r=Object(l.a)(e,2),i=r[0],c=r[1],s=(o.y-a.y)/(o.x-a.x),u=a.y-s*a.x;return 0===s?c=a.y:isFinite(s)?c=s*i+u:i=a.x,{x:i,y:c}};function b(e,t,n){var a=n.x-t.x,o=n.y-t.y,r=a*a+o*o,i=(e.x-t.x)*a+(e.y-t.y)*o,c=Math.min(1,Math.max(0,i/r));return i=(n.x-t.x)*(e.y-t.y)-(n.y-t.y)*(e.x-t.x),{point:{x:t.x+a*c,y:t.y+o*c},left:i<1,dot:i,t:c}}function h(e){var t=e.polygon,n=(e.isSelected,e.roomId),r=Object(a.useContext)(s);r.setPointer,r.setQuickMenuPosition,r.setQuickMenuState;return o.a.createElement("polygon",{id:"".concat(n+".floor"),points:t,fill:"#ffffaa",stroke:"steelblue",strokeWidth:8})}var y=function(e){var t=e.point,n=e.visible,r=Object(a.useContext)(s).__rooms,i=Object(l.a)(r,2),u=i[0],m=i[1],f=u.findIndex((function(e){return e.id===t.room}));return n?o.a.createElement(d.DraggableCore,{handle:".corner",onDrag:function(e,n){u[f].points[t.i].x=t.x+n.deltaX,u[f].points[t.i].y=t.y+n.deltaY,m(Object(c.a)(u))},onStop:function(){p(u).forEach((function(e){e.room===t.room&&e.i===t.i||(Math.abs(t.absX-e.absX)<16&&(u[f].points[t.i].x=e.absX-t.offsetX),Math.abs(t.absY-e.absY)<16&&(u[f].points[t.i].y=e.absY-t.offsetY))})),m(Object(c.a)(u))}},o.a.createElement("g",null,o.a.createElement("circle",{className:"corner",cx:t.x,cy:t.y,r:16,fill:"white",stroke:"#38a0f9",strokeWidth:4}),o.a.createElement("text",{x:t.x,y:t.y,textAnchor:"middle",alignmentBaseline:"central",pointerEvents:"none",fill:"grey"},t.i))):null},g=n(52);function v(e){var t=e.pathPoints,n=e.visible,r=Object(a.useContext)(s),i=r.__quickMenuPosition,u=r.__quickMenuState,m=r.__selectedPathPoints,f=r.__rooms,b=r.__pointer,h=r.__node,y=i[1],v=u[1],E=m[1],O=Object(l.a)(f,2),j=O[0],x=O[1],k=b[1],_=h[1],w=Object(a.useState)(!1),P=Object(l.a)(w,2),C=P[0],L=P[1],M=Object(l.a)(t,2),S=M[0],D=M[1],N=j.findIndex((function(e){return e.id===S.room})),X=[[S.x,S.y],[D.x,D.y]],W=Object(g.a)().x((function(e){return e[0]})).y((function(e){return e[1]})),Y=function(e){e.preventDefault();var n={x:null,y:null};"mouseup"===e.type?(n.x=e.clientX,n.y=e.clientY,k(n)):(console.log(e),console.log(e.originalEvent),n.x=e.changedTouches[0].clientX,n.y=e.changedTouches[0].clientY,k(n)),y(n),v((function(e){return!e})),E(t),_(e.target)};return o.a.createElement(d.DraggableCore,{handle:".segment",onDrag:function(e,t){L(!0),S.x+=t.deltaX,S.y+=t.deltaY,D.x+=t.deltaX,D.y+=t.deltaY,j[N].points[S.i].x=S.x,j[N].points[S.i].y=S.y,j[N].points[D.i].x=D.x,j[N].points[D.i].y=D.y,x(Object(c.a)(j))},onStop:function(e,n){if(C){L(!1);var a=p(j);t.forEach((function(e){a.forEach((function(t){e.id!==t.id&&(Math.abs(e.absX-t.absX)<=16&&(j[N].points[e.i].x=t.absX-e.offsetX),Math.abs(e.absY-t.absY)<=16&&(j[N].points[e.i].y=t.absY-e.offsetY))}))})),x(Object(c.a)(j))}else Y(e)},cancel:".doorCenter, .outlet"},o.a.createElement("path",{style:n?{visibility:"visible"}:{visibility:"hidden"},d:W(X),id:S.room+"."+S.i+"."+D.i,className:"segment",strokeWidth:20,stroke:"#77cfff",strokeLinecap:"round",strokeLinejoin:"round",opacity:.8}))}var E=function(e){var t=e.pathPoints,n=e.visible,a=Object(l.a)(t,2),r=a[0],i=a[1],c=r.x-i.x,s=r.y-i.y,u=Math.round(5*Math.floor(Math.sqrt(c*c+s*s)/5));return n?o.a.createElement("text",{style:{pointerEvents:"none",fill:"#404040"}},o.a.createElement("textPath",{startOffset:"45%",xlinkHref:"#"+r.room+"."+r.i+"."+i.i},u)):null},O=n(11);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function x(e){var t=e.door,n=e.i,r=Object(a.useContext)(s).__rooms,i=Object(l.a)(r,2),u=i[0],m=i[1],p=t.pointsIds,f=t.doorCenter,h=t.doorId,y=u.find((function(e){return e.id===p.a.split(".")[0]})),g=y.getPoints().find((function(e){return e.id===p.a})),v=y.getPoints().find((function(e){return e.id===p.b})),E={x:f.x-50,y:f.y-50},x={x:f.x+50,y:f.y+50},k=b(E,g,v).point,_=b(x,g,v).point;return o.a.createElement(d.DraggableCore,{handle:".doorCenter",onDrag:function(e,t){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(n,!0).forEach((function(t){Object(O.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},f);a.x+=t.deltaX,a.y+=t.deltaY;var o=b(a,g,v);y.doors[n].doorCenter.x=o.point.x,y.doors[n].doorCenter.y=o.point.y,m(Object(c.a)(u))}},o.a.createElement("line",{className:"doorCenter",id:h,x1:k.x,y1:k.y,x2:_.x,y2:_.y,fill:"#ffffaa",stroke:"#ffffaa",strokeWidth:8}))}n(70);var k=function(e){return e.props,o.a.createElement("g",null,o.a.createElement("title",null,"Lighting"),o.a.createElement("g",{id:"1",transform:"rotate(45)",style:{pointerEvents:"all"}},o.a.createElement("title",null,"Lighting"),o.a.createElement("g",{id:"2"},o.a.createElement("title",null,"Lighting"),o.a.createElement("path",{className:"component",d:"M-6 0 L6 0",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none"})),o.a.createElement("g",{id:"3"},o.a.createElement("title",null,"Lighting"),o.a.createElement("path",{className:"component",d:"M0 -6 L0 6",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none"}))))};var _=function(e){var t=e.props,n=t.type,a=t.grounding,r=t.shutter,i=e.angle;return o.a.createElement("g",{className:"outlet",style:{pointerEvents:"all"},transform:"translate(0 -2) rotate(270)"},o.a.createElement("text",{cursor:"default",transform:"translate(10 0) rotate(".concat(i?-i:0," )"),fontSize:"40%",textAnchor:"middle",alignmentBaseline:"central"},1===n?null:n),o.a.createElement("g",{id:"2",transform:"translate(0 -6)"},o.a.createElement("path",{d:"M3.54 11.58 L3.54 0.24",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:!0===a?"visible":"hidden",className:"component"}),o.a.createElement("path",{d:"M8.27 1.2 L8.27 0.25",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:!0===r?"visible":"hidden",className:"component"}),o.a.createElement("path",{d:"M8.27 11.6 L8.27 10.65",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:!0===r?"visible":"hidden",className:"component"}),o.a.createElement("path",{d:"M8.27 10.65 A4.72441 4.72441 0 0 1 3.55 5.93 A4.72441 4.72441 0 0 1 8.27 1.2",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",className:"component"}),o.a.createElement("path",{d:"M3.54 5.92 L-0 5.92",id:"coucou",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",className:"component"})))};var w=function(e,t){var n=e.props,a=n.type,r=n.pole,i=n.way;return n.dimmer,o.a.createElement("g",{className:"switch",style:{pointerEvents:"all"}},o.a.createElement("g",{id:"1"},o.a.createElement("g",{id:"2",transform:"translate(-5 -17)"},o.a.createElement("path",{d:"M8.55 10.53 A2.83465 2.83465 0 1 1 2.88 10.53 A2.83465 2.83465 0 1 1 8.55 10.53 Z",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",className:"component"}),o.a.createElement("path",{d:"M8.55 10.53 A2.83465 2.83465 0 1 1 2.88 10.53 A2.83465 2.83465 0 1 1 8.55 10.53 Z",transform:"translate(-4.5 -8.5) scale(1.8) ",vectorEffect:"non-scaling-stroke",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,fill:"none",visibility:"push"===a?"visible":"hidden",className:"component"}),o.a.createElement("path",{d:"M8.68 2.39 L10.65 3.11",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:2===r&&"switch"===a?"visible":"hidden",className:"component"}),o.a.createElement("path",{d:"M6.69 7.87 L9.46 0.24 L11.44 0.96",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:"push"===a?"hidden":"visible",className:"component"}),o.a.createElement("path",{d:"M6.69 7.87 L9.46 0.24 L11.44 0.96",transform:"scale(-1, 1) translate(-11 0)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:"inverter"===a?"visible":"hidden",className:"component"}),o.a.createElement("path",{d:"M8.55 10.53 A2.83465 2.83465 0 1 1 2.88 10.53 A2.83465 2.83465 0 1 1 8.55 10.53",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:"hidden",className:"component"}),o.a.createElement("path",{d:"M2.76 18.68 L0.78 17.96",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:2===r&&"switch"===a&&2===i?"visible":"hidden",className:"component"}),o.a.createElement("path",{d:"M4.75 13.2 L1.97 20.83 L0 20.11",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:2===i&&"switch"===a||"inverter"===a?"visible":"hidden",className:"component"}),o.a.createElement("path",{d:"M4.75 13.2 L1.97 20.83 L0 20.11",transform:"scale(-1, 1) translate(-11 0)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:"inverter"===a?"visible":"hidden",className:"component"}))))};var P=function(e,t){var n=e.circuit;return o.a.createElement("text",{cursor:"default",fontSize:"0.6em",fontWeight:"small",transform:"translate(0 -17) )",textAnchor:"middle"},"".concat(n.name).concat(n.number).toUpperCase())};function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var L=function(e){var t=e.component,n=e.i,r=Object(a.useContext)(s),i=r.__rooms,u=r.__componentPropertiesMenu,m=r.__linkers,p=r.__links,f=r.__anchorEl,h=r.__preMenu,y=r.__selectedComponent,g=r.__isLinking,v=Object(l.a)(i,2),E=v[0],j=v[1],x=Object(l.a)(u,2),L=(x[0],x[1],Object(l.a)(m,2)),M=L[0],S=L[1],D=Object(l.a)(p,2),N=D[0],X=D[1],W=Object(l.a)(f,2),Y=(W[0],W[1]),I=Object(l.a)(h,2),A=(I[0],I[1]),q=Object(l.a)(y,2),R=(q[0],q[1]),B=Object(l.a)(g,2),T=B[0],H=B[1],F=E.find((function(e){return e.id===t.room.id})),U=t.anchorPoint,z=t.category,J=t.node,K=U.x,Q=U.y,Z=Object(a.useState)(!1),G=Object(l.a)(Z,2),V=G[0],$=G[1],ee=Object(a.useState)(!1),te=Object(l.a)(ee,2),ne=te[0],ae=te[1],oe=Object(a.useState)({}),re=Object(l.a)(oe,2),ie=re[0],ce=re[1],le=Object(a.useRef)();if(Object(a.useEffect)((function(){var e=le.current;ce(e.getBBox())}),[t.props.type]),Object(a.useEffect)((function(){1===M.length?H(!0):H(!1),M.length>=2&&(X([].concat(Object(c.a)(N),[M])),S([]))}),[M]),!t)return null;if("path"===t.node.nodeName){var se=J.id.split(".")[0]+"."+J.id.split(".")[1],ue=J.id.split(".")[0]+"."+J.id.split(".")[2],de=F.getPoints().find((function(e){return e.id===se})),me=F.getPoints().find((function(e){return e.id===ue})),pe=b(U,de,me);K=pe.point.x,Q=pe.point.y;var fe=180*Math.atan2(me.y-de.y,me.x-de.x)/Math.PI-90}return o.a.createElement(d.DraggableCore,{handle:"."+t.category,onDrag:function(e,a){$(!0);var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(n,!0).forEach((function(t){Object(O.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},U);if(o.x+=a.deltaX,o.y+=a.deltaY,"path"===t.node.nodeName){var r=J.id.split(".")[0]+"."+J.id.split(".")[1],i=J.id.split(".")[0]+"."+J.id.split(".")[2],l=b(o,F.getPoints().find((function(e){return e.id===r})),F.getPoints().find((function(e){return e.id===i})));F.components[n].anchorPoint.x=l.point.x,F.components[n].anchorPoint.y=l.point.y}else F.components[n].anchorPoint.x=o.x,F.components[n].anchorPoint.y=o.y;j(Object(c.a)(E))},onStop:function(e){if(!V){if(T)return void S((function(e){return[].concat(Object(c.a)(e),[le.current])}));Y(le.current),A({open:!0}),R(t)}$(!1)}},o.a.createElement("g",{className:z,id:t.id,transform:"translate(".concat(K," ").concat(Q,") scale(1.75) "),pointerEvents:"all",onMouseEnter:function(){return ae(!0)},onMouseLeave:function(){return ae(!1)}},o.a.createElement("rect",{className:"bbox",transform:"rotate(".concat(fe?0===fe?80:fe+90:0,") "),x:ie.x,y:ie.y,width:ie.width,height:ie.height,fill:"steelblue",opacity:.3,visibility:ne?"visible":"hidden"}),o.a.createElement("g",{className:"component ".concat(T?"linking":null),ref:le,transform:"rotate(".concat(fe?0===fe?80:fe+90:0,") "),stroke:"black",strokeWidth:".2"},function(e){switch(e){case"switch":return o.a.createElement(w,{props:t.props,angle:fe});case"outlet":return o.a.createElement(_,{props:t.props,angle:fe});case"lamp":return o.a.createElement(k,{props:t.props,angle:fe});default:return null}}(t.category)),o.a.createElement("g",{className:"circuit",transform:"rotate(".concat(fe?0===fe?80:fe+90:90,") translate (",0," ").concat(ie.y,") ")},o.a.createElement(P,{circuit:t.props.circuit}))))};var M=function(e){var t,n=e.isSelected,r=e.room,i=e.i,u=Object(a.useContext)(s),f=u.__rooms,b=u.__selectedRoom,g=u.__pointer,O=u.__quickMenuPosition,j=u.__quickMenuState,k=u.__node,_=Object(l.a)(f,2),w=_[0],P=_[1],C=b[1],M=Object(l.a)(g,2),S=(M[0],M[1]),D=Object(l.a)(O,2),N=(D[0],D[1]),X=Object(l.a)(j,2),W=(X[0],X[1]),Y=Object(l.a)(k,2),I=(Y[0],Y[1]),A=Object(a.useState)(!1),q=Object(l.a)(A,2),R=q[0],B=q[1],T=Object(a.useState)(!1),H=Object(l.a)(T,2);return H[0],H[1],o.a.createElement(d.DraggableCore,{handle:".room",cancel:".corner, .segment, .doorCenter, .outlet, .switch, .lamp",disabled:!n,onStop:function(e){if(R){B(!1);var t=p(w);r.getPoints().forEach((function(e){t.forEach((function(t){var n=Math.abs(e.absX-t.absX),a=Math.abs(e.absY-t.absY);e.room!==t.room&&(n<=16&&(w[i].points[e.i].x=t.absX-e.offsetX),a<=16&&(w[i].points[e.i].y=t.absY-e.offsetY))}))})),P(Object(c.a)(w))}else n&&function(e){e.preventDefault();var t={x:null,y:null};"mouseup"===e.type||"click"===e.type?(t.x=e.clientX,t.y=e.clientY,S(t)):(console.log(e),console.log(e.originalEvent),t.x=e.changedTouches[0].clientX,t.y=e.changedTouches[0].clientY,S(t)),N(t),W((function(e){return!e})),I(e.target)}(e)},onDrag:function(e,t){e.preventDefault(),B(!0);var n=Object(c.a)(w);n[i].x+=t.deltaX,n[i].y+=t.deltaY,P(n)}},o.a.createElement("g",{className:"room",id:r.id,transform:"translate(".concat(r.x," ").concat(r.y,")"),onClick:function(e){C(r.id)},onKeyDown:function(e){n&&8===e.keyCode&&P((function(e){return e.filter((function(e){return e.id!==r.id}))}))},tabIndex:-1,style:{outline:0}},o.a.createElement(h,{polygon:(t=r.getPoints(),t.map((function(e){return[e.x,e.y].join(" ")}))),isSelected:n,roomId:r.id}),m(r.getPoints()).map((function(e,t){return o.a.createElement(v,{key:t,pathPoints:e,visible:n})})),r.getPoints().map((function(e,t){return o.a.createElement(y,{key:t,point:e,visible:n})})),m(r.getPoints()).map((function(e,t){return o.a.createElement(E,{key:t,pathPoints:e,visible:n})})),r.doors.map((function(e,t){return o.a.createElement(x,{key:t,door:e,i:t})})),r.components.map((function(e,t){return o.a.createElement(L,{key:t,component:e,i:t})}))))},S=function(e){var t=e.link,n=t[0].getBoundingClientRect(),a=t[1].getBoundingClientRect(),r={x:(n.left+n.right)/2,y:(n.top+n.bottom)/2},i={x:(a.left+a.right)/2,y:(a.top+a.bottom)/2},c={x:(r.x+i.x)/2+20,y:(r.y+i.y)/2+20},l={x:(r.x+i.x)/2-20,y:(r.y+i.y)/2-20};return o.a.createElement("g",null,o.a.createElement("path",{d:"M ".concat(r.x," ").concat(r.y," C ").concat(c.x," ").concat(c.y,", ").concat(l.x," ").concat(l.y,", ").concat(i.x," ").concat(i.y),stroke:"red",strokeWidth:2,fill:"transparent",strokeDasharray:4}))};function D(){var e=Object(a.useContext)(s),t=e.__rooms,n=e.__selectedRoom,r=e.__components,i=e.__links,d=Object(l.a)(t,1)[0],m=Object(l.a)(i,2),p=m[0],f=(m[1],Object(l.a)(r,1)[0],Object(l.a)(n,1)[0]),b=window.innerWidth,h=window.innerHeight;return o.a.createElement("svg",{id:"plan",width:b,height:h,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},o.a.createElement(u,{width:b,height:h}),d.sort((function(e,t){var n=e.id===f;return n===(t.id===f)?0:n?1:-1})).map((function(e,t){return o.a.createElement(M,{key:e.id,isSelected:f===e.id,room:e,i:t})})),d.reduce((function(e,t,n){return e.push.apply(e,Object(c.a)(t.doors)),e}),[]).map((function(e,t){var n=d.find((function(t){return t.id===e.doorId.split(".")[0]}));return console.log("#"+e.doorId),o.a.createElement("use",{key:t,xlinkHref:"#"+e.doorId,transform:"translate(".concat(n.x," ").concat(n.y,")")})})),p.map((function(e,t){return o.a.createElement(S,{key:t,link:e})})))}n(71);var N=n(53),X=n(116);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(n,!0).forEach((function(t){Object(O.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=function(){var e=Object(a.useContext)(s),t=e.__rooms,n=e.__components,r=e.__quickMenuPosition,i=e.__quickMenuState,u=e.__selectedPathPoints,d=e.__pointer,m=e.__componentPropertiesMenu,b=e.__node,h=Object(l.a)(t,2),y=h[0],g=h[1],v=Object(l.a)(n,2),E=(v[0],v[1],Object(l.a)(r,2)),O=E[0],j=E[1],x=Object(l.a)(i,2),k=x[0],_=x[1],w=Object(l.a)(u,1)[0],P=Object(l.a)(d,1)[0],C=Object(l.a)(m,2),L=(C[0],C[1],Object(l.a)(b,2)),M=L[0];L[1];if(!M)return null;var S=function(){_(!1),j(null)},D=function(e){var t,n=y.find((function(e){return e.id===M.id.split(".")[0]})),a={x:P.x-n.x,y:P.y-n.y},o=y.find((function(e){return e.id===n.id})).components.filter((function(t){return t.category===e.target.id})).length,r=e.target.id,i=n.id+".".concat(r,".")+o;switch(e.target.id){case"lamp":t={circuit:{name:"",number:""}};break;case"outlet":t={type:1,grounding:!0,shutter:!0,circuit:{name:"",number:""}};break;case"switch":t={way:1,pole:1,dimmer:!1,illuminated:!1,type:"switch",circuit:{name:"",number:""}}}var l={anchorPoint:a,id:i,category:r,room:n,node:M,props:t};n.components.push(l),g(Object(c.a)(y)),S()};return o.a.createElement(N.a,{id:"quickMenu",transitionDuration:{enter:0,exit:0},anchorReference:"anchorPosition",anchorPosition:null!==O?{top:O.y,left:O.x}:void 0,open:k,onClose:S},"path"===M.nodeName?o.a.createElement(X.a,{onClick:function(e){var t=Object(l.a)(w,1)[0],n=y.findIndex((function(e){return e.id===t.room})),a=P.x-y[n].x,o=P.y-y[n].y,r=f([a,o],w);p(y).forEach((function(e){Math.abs(e.absX-(r.x+y[n].x))<16&&(r.x=e.absX-y[n].x),Math.abs(e.absY-(r.y+y[n].y))<16&&(r.y=e.absY-y[n].y)}));var i=Y({},r),s=Y({},r);y[n].points.splice(t.i+1,0,i,s),g(Object(c.a)(y)),S()}},"add corner"):null,"path"===M.nodeName?o.a.createElement(X.a,{onClick:function(){var e=Object(l.a)(w,2),t=e[0],n=e[1],a=y.findIndex((function(e){return e.id===t.room})),o=P.x-y[a].x,r=P.y-y[a].y,i=f([o,r],w),s=y[a].id+".door."+y[a].doors.length,u={pointsIds:{a:t.id,b:n.id},doorCenter:i,doorId:s};y[a].doors.push(u),g(Object(c.a)(y)),S()}},"add door"):null,o.a.createElement(X.a,{onClick:D,id:"outlet"},"add outlet"),o.a.createElement(X.a,{onClick:D,id:"switch"},"add switch"),"polygon"===M.nodeName?o.a.createElement(X.a,{onClick:D,id:"lamp"},"add lamp"):null)},A=n(114),q=n(110),R=n(78),B=n(108),T=n(111),H=n(117),F=n(109);var U=function(e){var t=e.props,n=e.handleChange,a=t.way,r=t.pole,i=t.dimmer,c=t.illuminated,l=t.type;return o.a.createElement(B.a,{container:!0,direction:"column",spacing:1},o.a.createElement(B.a,{item:!0},o.a.createElement(B.a,{container:!0,direction:"column"},o.a.createElement(B.a,{item:!0,xs:12},o.a.createElement(H.a,{exclusive:!0,"aria-label":"text alignment",value:l,onChange:n},o.a.createElement(F.a,{id:"type",value:"switch",selected:"switch"===l},"Switch"),o.a.createElement(F.a,{id:"type",value:"push",selected:"push"===l},"Push"),o.a.createElement(F.a,{id:"type",value:"inverter",selected:"inverter"===l},"Inverter"))),o.a.createElement(B.a,{item:!0,xs:12},o.a.createElement(H.a,{exclusive:!0,"aria-label":"text alignment",value:a,onChange:n},o.a.createElement(F.a,{value:1,id:"way",selected:1===a&&"switch"===l,disabled:"switch"!==l},"Single throw"),o.a.createElement(F.a,{value:2,id:"way",selected:2===a&&"switch"===l,disabled:"switch"!==l},"Double throw"))),o.a.createElement(B.a,{item:!0,xs:12},o.a.createElement(H.a,{exclusive:!0,"aria-label":"text alignment",value:r,onChange:n},o.a.createElement(F.a,{value:1,id:"pole",selected:1===r&&"switch"===l,disabled:"switch"!==l},"Single Pole"),o.a.createElement(F.a,{id:"pole",value:2,selected:2===r&&"switch"===l,disabled:"switch"!==l},"Double Pole"))),o.a.createElement(B.a,{item:!0},o.a.createElement(F.a,{id:"dimmer",value:i,selected:i,onChange:n},"Dimmer")),o.a.createElement(B.a,{item:!0},o.a.createElement(F.a,{id:"illuminated",value:c,selected:c,onChange:n},"Illuminated")))))};var z=function(e){var t=e.props,n=e.handleChange,a=t.shutter,r=t.type,i=t.grounding;return o.a.createElement(B.a,{container:!0,direction:"column",spacing:1},o.a.createElement(B.a,{item:!0},o.a.createElement(B.a,{container:!0,direction:"column"},o.a.createElement(B.a,{item:!0,xs:12},o.a.createElement(H.a,{exclusive:!0,"aria-label":"text alignment",value:r,onChange:n},o.a.createElement(F.a,{id:"type",value:1,selected:1===r},"ONE"),o.a.createElement(F.a,{id:"type",value:2,selected:2===r},"TWO"),o.a.createElement(F.a,{id:"type",value:3,selected:3===r},"THREE"),o.a.createElement(F.a,{id:"type",value:4,selected:4===r},"FOOR"),o.a.createElement(F.a,{id:"type",value:5,selected:5===r},"FIVE"))))),o.a.createElement(B.a,{item:!0},o.a.createElement(B.a,{container:!0,justify:"center",spacing:0},o.a.createElement(B.a,{item:!0,xs:6,style:{textAlign:"center"}},o.a.createElement(F.a,{id:"grounding",value:i,selected:i,onChange:n},"Grounding")),o.a.createElement(B.a,{item:!0,xs:6,style:{textAlign:"center"}},o.a.createElement(F.a,{id:"shutter",value:a,selected:a,onChange:n},"Shutter")))))};var J=function(e){return o.a.createElement("div",null,"lamp properties")},K=n(112);var Q=function(e){var t=e.circuit,n=e.handleChange,r=Object(a.useState)(t.name),i=Object(l.a)(r,2),c=i[0],s=i[1];return o.a.createElement(K.a,{id:"circuit",label:"Circuit",margin:"normal",variant:"filled",onChange:function(e){s(e.target.value),n(e)},value:c?c.toUpperCase():""})};var Z=function(){var e=Object(a.useContext)(s),t=e.__componentPropertiesMenu,n=e.__rooms,r=Object(l.a)(t,2),i=r[0],u=r[1],d=Object(l.a)(n,2),m=d[0],p=d[1],f=(i.open,i.component);if(!f)return null;var b=m.findIndex((function(e){return e.id===f.room.id})),h=m[b].components.findIndex((function(e){return e.id===f.id})),y=function(e){var t=e.currentTarget.value;"true"===t?t=!1:"false"===t?t=!0:""===t?t="":isNaN(t)||(t=parseInt(t));var n=e.currentTarget.id;"circuit"===n?(m[b].components[h].props[n].name=t,m[b].components[h].props[n].number=function(e,t){var n=e.reduce((function(e,t,n){return e.push.apply(e,Object(c.a)(t.components)),e}),[]).filter((function(e){return e.props.circuit.name.toLowerCase()===t.toLowerCase()}));return console.log(n.length),n.length}(m,t)):m[b].components[h].props[n]=t,p(Object(c.a)(m))};return o.a.createElement(A.a,{open:i.open,onClose:function(){u({})}},o.a.createElement(q.a,null,"Set component properties"),o.a.createElement(R.a,null,"id : ",f.id),o.a.createElement(Q,{circuit:f.props.circuit,handleChange:y}),function(e){switch(e){case"switch":return o.a.createElement(U,{props:f.props,handleChange:y});case"outlet":return o.a.createElement(z,{props:f.props,handleChange:y});case"lamp":return o.a.createElement(J,{props:f.props,handleChange:y})}}(f.category),o.a.createElement(B.a,{item:!0},o.a.createElement(T.a,{onClick:function(){return u({open:!1})},variant:"contained",color:"primary",fullWidth:!0},"Save")))},G=n(50),V=n.n(G),$=n(51),ee=n.n($);var te=function(){var e=Object(a.useContext)(s),t=e.__preMenu,n=e.__anchorEl,r=e.__componentPropertiesMenu,i=e.__selectedComponent,u=e.__linkers,d=Object(l.a)(t,2),m=d[0],p=d[1],f=Object(l.a)(n,2),b=f[0],h=f[1],y=Object(l.a)(r,2),g=(y[0],y[1]),v=Object(l.a)(i,1)[0],E=Object(l.a)(u,2),O=(E[0],E[1]);if(console.log(b),null!==b){var j=function(){p({open:!1}),h(null)};return o.a.createElement(N.a,{id:"pre-menu",anchorEl:b,open:m.open,onClose:j},o.a.createElement(X.a,{onMouseDown:function(){console.log("premenu is clicked"),j(),g({open:!0,component:v})}},o.a.createElement(V.a,null)),o.a.createElement(X.a,{onMouseDown:function(){console.log("premenu is clicked 2"),j(),O((function(e){return[].concat(Object(c.a)(e),[b])}))}},o.a.createElement(ee.a,null)))}};var ne=function(){var e=Object(a.useState)([]),t=Object(a.useState)([]),n=Object(a.useState)([]),r=Object(a.useState)(null),i=Object(a.useState)(!1),c=Object(a.useState)(null),l=Object(a.useState)(null),u=Object(a.useState)(null),d=Object(a.useState)([]),m=Object(a.useState)(null),p=Object(a.useState)({open:!1}),f=Object(a.useState)({open:!1}),b={__rooms:e,__components:t,__links:n,__quickMenuPosition:r,__quickMenuState:i,__selectedRoom:c,__selectedPathPoints:l,__pointer:u,__doors:d,__node:m,__componentPropertiesMenu:p,__linkers:Object(a.useState)([]),__preMenu:f,__anchorEl:Object(a.useState)(null),__selectedComponent:Object(a.useState)(null),__isLinking:Object(a.useState)(!1)};return o.a.createElement("div",{className:"App",style:{overscrollBehavior:"none"},onContextMenu:function(e){return e.preventDefault()}},o.a.createElement(s.Provider,{value:b},o.a.createElement(D,null),o.a.createElement(I,null),o.a.createElement(Z,null),o.a.createElement(te,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(ne,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[64,1,2]]]);
//# sourceMappingURL=main.7b2e42de.chunk.js.map