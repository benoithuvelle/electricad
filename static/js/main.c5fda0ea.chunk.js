(this.webpackJsonpelectricad=this.webpackJsonpelectricad||[]).push([[0],{58:function(e,t,n){e.exports=n(69)},63:function(e,t,n){},64:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(8),i=n.n(o),c=(n(63),n(7)),l=n(5),s=Object(r.createContext)(null);function u(e){var t=e.width,n=e.height,o=Object(r.useContext)(s),i=o.__selectedRoom,u=o.__rooms,d=Object(l.a)(u,2),p=d[0],m=d[1],f=i[1],h=function(e){var r=window.prompt("D\xe9nomination de la pi\xe8ce");if(""!==r&&null!==r)if(p.find((function(e){return e.id===r})))alert("Une pi\xe8ce nomm\xe9e ".concat(r," existe d\xe9j\xe0. Cr\xe9ation annul\xe9e !!!"));else{var a={id:r,x:e.clientX?e.clientX-75:t/2,y:e.clientY?e.clientY-75:n/2,points:[{x:0,y:0},{x:0,y:200},{x:200,y:200},{x:200,y:0}],getPoints:function(){var e=this;return this.points.reduce((function(t,n,a){return t[a]={x:n.x,y:n.y,absX:n.x+e.x,absY:n.y+e.y,offsetX:e.x,offsetY:e.y,i:a,room:r,id:"".concat(e.id,".").concat(a)},t}),[])},doors:[],outlets:[],switches:[],lamps:[],components:[]};m([].concat(Object(c.a)(p),[a])),f(a.id)}};return a.a.createElement("rect",{style:{outline:"none"},tabIndex:-1,id:"background",width:t,height:n,fill:"#38a0f9",onDoubleClick:h,onClick:function(){return f(null)},onKeyDown:function(e){78===e.keyCode&&h(e)}})}var d=n(15);function p(e){return e.reduce((function(t,n,r){return t[r]=[n],r>0&&t[r-1].push(n),r===e.length-1&&t[r].push(t[0][0]),t}),[])}function m(e){return e.reduce((function(e,t,n){var r=t.getPoints();return e.push.apply(e,Object(c.a)(r)),e}),[])}var f=function(e,t){var n=Object(l.a)(t,2),r=n[0],a=n[1],o=Object(l.a)(e,2),i=o[0],c=o[1],s=(a.y-r.y)/(a.x-r.x),u=r.y-s*r.x;return 0===s?c=r.y:isFinite(s)?c=s*i+u:i=r.x,{x:i,y:c}};function h(e,t,n){var r=n.x-t.x,a=n.y-t.y,o=r*r+a*a,i=(e.x-t.x)*r+(e.y-t.y)*a,c=Math.min(1,Math.max(0,i/o));return i=(n.x-t.x)*(e.y-t.y)-(n.y-t.y)*(e.x-t.x),{point:{x:t.x+r*c,y:t.y+a*c},left:i<1,dot:i,t:c}}function b(e){var t=e.polygon,n=(e.isSelected,e.roomId),o=Object(r.useContext)(s);o.setPointer,o.setQuickMenuPosition,o.setQuickMenuState;return a.a.createElement("polygon",{id:"".concat(n+".floor"),points:t,fill:"#ffffaa",stroke:"steelblue",strokeWidth:8})}var y=function(e){var t=e.point,n=e.visible,o=Object(r.useContext)(s).__rooms,i=Object(l.a)(o,2),u=i[0],p=i[1],f=u.findIndex((function(e){return e.id===t.room}));return n?a.a.createElement(d.DraggableCore,{handle:".corner",onDrag:function(e,n){u[f].points[t.i].x=t.x+n.deltaX,u[f].points[t.i].y=t.y+n.deltaY,p(Object(c.a)(u))},onStop:function(){m(u).forEach((function(e){e.room===t.room&&e.i===t.i||(Math.abs(t.absX-e.absX)<16&&(u[f].points[t.i].x=e.absX-t.offsetX),Math.abs(t.absY-e.absY)<16&&(u[f].points[t.i].y=e.absY-t.offsetY))})),p(Object(c.a)(u))}},a.a.createElement("g",null,a.a.createElement("circle",{className:"corner",cx:t.x,cy:t.y,r:16,fill:"white",stroke:"#38a0f9",strokeWidth:4}),a.a.createElement("text",{x:t.x,y:t.y,textAnchor:"middle",alignmentBaseline:"central",pointerEvents:"none",fill:"grey"},t.i))):null},v=n(46);function g(e){var t=e.pathPoints,n=e.visible,o=Object(r.useContext)(s),i=o.__quickMenuPosition,u=o.__quickMenuState,p=o.__selectedPathPoints,f=o.__rooms,h=o.__pointer,b=o.__node,y=i[1],g=u[1],E=p[1],x=Object(l.a)(f,2),k=x[0],O=x[1],j=h[1],_=b[1],w=Object(r.useState)(!1),P=Object(l.a)(w,2),C=P[0],L=P[1],M=Object(l.a)(t,2),S=M[0],D=M[1],X=k.findIndex((function(e){return e.id===S.room})),Y=[[S.x,S.y],[D.x,D.y]],W=Object(v.a)().x((function(e){return e[0]})).y((function(e){return e[1]})),I=function(e){e.preventDefault();var n={x:null,y:null};"mouseup"===e.type?(n.x=e.clientX,n.y=e.clientY,j(n)):(console.log(e),console.log(e.originalEvent),n.x=e.changedTouches[0].clientX,n.y=e.changedTouches[0].clientY,j(n)),y(n),g((function(e){return!e})),E(t),_(e.target)};return a.a.createElement(d.DraggableCore,{handle:".segment",onDrag:function(e,t){L(!0),S.x+=t.deltaX,S.y+=t.deltaY,D.x+=t.deltaX,D.y+=t.deltaY,k[X].points[S.i].x=S.x,k[X].points[S.i].y=S.y,k[X].points[D.i].x=D.x,k[X].points[D.i].y=D.y,O(Object(c.a)(k))},onStop:function(e,n){if(C){L(!1);var r=m(k);t.forEach((function(e){r.forEach((function(t){e.id!==t.id&&(Math.abs(e.absX-t.absX)<=16&&(k[X].points[e.i].x=t.absX-e.offsetX),Math.abs(e.absY-t.absY)<=16&&(k[X].points[e.i].y=t.absY-e.offsetY))}))})),O(Object(c.a)(k))}else I(e)},cancel:".doorCenter, .outlet"},a.a.createElement("path",{style:n?{visibility:"visible"}:{visibility:"hidden"},d:W(Y),id:S.room+"."+S.i+"."+D.i,className:"segment",strokeWidth:20,stroke:"#77cfff",strokeLinecap:"round",strokeLinejoin:"round",opacity:.8}))}var E=function(e){var t=e.pathPoints,n=e.visible,r=Object(l.a)(t,2),o=r[0],i=r[1],c=o.x-i.x,s=o.y-i.y,u=Math.round(5*Math.floor(Math.sqrt(c*c+s*s)/5));return n?a.a.createElement("text",{style:{pointerEvents:"none",fill:"#404040"}},a.a.createElement("textPath",{startOffset:"45%",xlinkHref:"#"+o.room+"."+o.i+"."+i.i},u)):null},x=n(11);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){var t=e.door,n=e.i,o=Object(r.useContext)(s).__rooms,i=Object(l.a)(o,2),u=i[0],p=i[1],m=t.pointsIds,f=t.doorCenter,b=t.doorId,y=u.find((function(e){return e.id===m.a.split(".")[0]})),v=y.getPoints().find((function(e){return e.id===m.a})),g=y.getPoints().find((function(e){return e.id===m.b})),E={x:f.x-50,y:f.y-50},O={x:f.x+50,y:f.y+50},j=h(E,v,g).point,_=h(O,v,g).point;return a.a.createElement(d.DraggableCore,{handle:".doorCenter",onDrag:function(e,t){var r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(n,!0).forEach((function(t){Object(x.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},f);r.x+=t.deltaX,r.y+=t.deltaY;var a=h(r,v,g);y.doors[n].doorCenter.x=a.point.x,y.doors[n].doorCenter.y=a.point.y,p(Object(c.a)(u))}},a.a.createElement("line",{className:"doorCenter",id:b,x1:j.x,y1:j.y,x2:_.x,y2:_.y,fill:"#ffffaa",stroke:"#ffffaa",strokeWidth:8}))}var j=function(e){return e.props,a.a.createElement("g",null,a.a.createElement("rect",{x:0,y:0,height:12,width:12,visibility:"hidden",style:{pointerEvents:"all"}}),a.a.createElement("title",null,"Lighting"),a.a.createElement("g",{id:"1",transform:"translate(0.125,-0.125)",style:{pointerEvents:"all"}},a.a.createElement("title",null,"Lighting"),a.a.createElement("g",{id:"2",transform:"translate(8.27502,-7.97777) rotate(45)"},a.a.createElement("title",null,"Lighting"),a.a.createElement("path",{d:"M0 11.64 L15.91 11.64",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none"})),a.a.createElement("g",{id:"3",transform:"translate(19.6136,8.47777) rotate(135)"},a.a.createElement("title",null,"Lighting"),a.a.createElement("path",{d:"M0 11.64 L16.1 11.64",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none"}))))};var _=function(e){console.log(e);var t=e.props,n=t.type,r=t.grounding,o=t.shutter,i=e.angle;return a.a.createElement("g",{className:"outlet",style:{pointerEvents:"all"},transform:"translate(0 -2) rotate(270)"},a.a.createElement("text",{transform:"translate(10 0) rotate(".concat(i?-i:0," )"),fontSize:"50%",textAnchor:"middle",alignmentBaseline:"central"},1===n?null:n),a.a.createElement("g",{id:"2",transform:"translate(0 -6)"},a.a.createElement("path",{d:"M3.54 11.58 L3.54 0.24",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:!0===r?"visible":"hidden"}),a.a.createElement("path",{d:"M8.27 1.2 L8.27 0.25",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:!0===o?"visible":"hidden"}),a.a.createElement("path",{d:"M8.27 11.6 L8.27 10.65",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:!0===o?"visible":"hidden"}),a.a.createElement("path",{d:"M8.27 10.65 A4.72441 4.72441 0 0 1 3.55 5.93 A4.72441 4.72441 0 0 1 8.27 1.2",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none"}),a.a.createElement("path",{d:"M3.54 5.92 L-0 5.92",id:"coucou",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none"})))};var w=function(e,t){var n=e.props,r=n.type,o=n.pole,i=n.way;return n.dimmer,a.a.createElement("g",{className:"switch",style:{pointerEvents:"all"}},a.a.createElement("g",{id:"1"},a.a.createElement("g",{id:"2",transform:"translate(-5 -17)"},a.a.createElement("path",{d:"M8.55 10.53 A2.83465 2.83465 0 1 1 2.88 10.53 A2.83465 2.83465 0 1 1 8.55 10.53 Z",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none"}),a.a.createElement("path",{d:"M8.55 10.53 A2.83465 2.83465 0 1 1 2.88 10.53 A2.83465 2.83465 0 1 1 8.55 10.53 Z",transform:"translate(-4.5 -8.5) scale(1.8) ",vectorEffect:"non-scaling-stroke",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,fill:"none",visibility:"push"===r?"visible":"hidden"}),a.a.createElement("path",{d:"M8.68 2.39 L10.65 3.11",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:2===o&&"switch"===r?"visible":"hidden"}),a.a.createElement("path",{d:"M6.69 7.87 L9.46 0.24 L11.44 0.96",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:"push"===r?"hidden":"visible"}),a.a.createElement("path",{d:"M6.69 7.87 L9.46 0.24 L11.44 0.96",transform:"scale(-1, 1) translate(-11 0)",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:"inverter"===r?"visible":"hidden"}),a.a.createElement("path",{d:"M8.55 10.53 A2.83465 2.83465 0 1 1 2.88 10.53 A2.83465 2.83465 0 1 1 8.55 10.53",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:"hidden"}),a.a.createElement("path",{d:"M2.76 18.68 L0.78 17.96",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:2===o&&"switch"===r&&2===i?"visible":"hidden"}),a.a.createElement("path",{d:"M4.75 13.2 L1.97 20.83 L0 20.11",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:2===i&&"switch"===r||"inverter"===r?"visible":"hidden"}),a.a.createElement("path",{d:"M4.75 13.2 L1.97 20.83 L0 20.11",transform:"scale(-1, 1) translate(-11 0)",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,fill:"none",visibility:"inverter"===r?"visible":"hidden"}))))};var P=function(e){var t=e.circuit;return a.a.createElement("text",{fontSize:"0.6em",transform:"translate(-3 -17)"},"".concat(t.name).concat(t.number).toUpperCase())};function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var L=function(e){var t=e.component,n=e.i,o=Object(r.useContext)(s),i=o.__rooms,u=o.__componentPropertiesMenu,p=Object(l.a)(i,2),m=p[0],f=p[1],b=Object(l.a)(u,2),y=(b[0],b[1]),v=m.find((function(e){return e.id===t.room.id})),g=t.anchorPoint,E=t.category,k=t.node,O=g.x,L=g.y,M=Object(r.useState)(!1),S=Object(l.a)(M,2),D=S[0],X=S[1];if(!t)return null;if("path"===t.node.nodeName){var Y=k.id.split(".")[0]+"."+k.id.split(".")[1],W=k.id.split(".")[0]+"."+k.id.split(".")[2],I=v.getPoints().find((function(e){return e.id===Y})),N=v.getPoints().find((function(e){return e.id===W})),A=h(g,I,N);O=A.point.x,L=A.point.y;var q=180*Math.atan2(N.y-I.y,N.x-I.x)/Math.PI-90}return a.a.createElement(d.DraggableCore,{handle:"."+t.category,onDrag:function(e,r){X(!0);var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(n,!0).forEach((function(t){Object(x.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},g);if(a.x+=r.deltaX,a.y+=r.deltaY,"path"===t.node.nodeName){var o=k.id.split(".")[0]+"."+k.id.split(".")[1],i=k.id.split(".")[0]+"."+k.id.split(".")[2],l=h(a,v.getPoints().find((function(e){return e.id===o})),v.getPoints().find((function(e){return e.id===i})));v.components[n].anchorPoint.x=l.point.x,v.components[n].anchorPoint.y=l.point.y}else v.components[n].anchorPoint.x=a.x,v.components[n].anchorPoint.y=a.y;f(Object(c.a)(m))},onStop:function(e){D||y({open:!0,component:t}),X(!1)}},a.a.createElement("g",{className:E,transform:"translate(".concat(O," ").concat(L,") scale(1.75) rotate(").concat(q?0===q?80:q+90:90,") ")},function(e){switch(e){case"switch":return a.a.createElement(w,{props:t.props,angle:q});case"outlet":return a.a.createElement(_,{props:t.props,angle:q});case"lamp":return a.a.createElement(j,{props:t.props});default:return null}}(t.category),a.a.createElement(P,{circuit:t.props.circuit})))};var M=function(e){var t,n=e.isSelected,o=e.room,i=e.i,u=Object(r.useContext)(s),f=u.__rooms,h=u.__selectedRoom,v=u.__pointer,x=u.__quickMenuPosition,k=u.__quickMenuState,j=u.__node,_=Object(l.a)(f,2),w=_[0],P=_[1],C=h[1],M=Object(l.a)(v,2),S=(M[0],M[1]),D=Object(l.a)(x,2),X=(D[0],D[1]),Y=Object(l.a)(k,2),W=(Y[0],Y[1]),I=Object(l.a)(j,2),N=(I[0],I[1]),A=Object(r.useState)(!1),q=Object(l.a)(A,2),T=q[0],R=q[1];return a.a.createElement(d.DraggableCore,{handle:".room",cancel:".corner, .segment, .doorCenter, .outlet, .switch, .lamp",disabled:!n,onStop:function(e){if(T){R(!1);var t=m(w);o.getPoints().forEach((function(e){t.forEach((function(t){var n=Math.abs(e.absX-t.absX),r=Math.abs(e.absY-t.absY);e.room!==t.room&&(n<=16&&(w[i].points[e.i].x=t.absX-e.offsetX),r<=16&&(w[i].points[e.i].y=t.absY-e.offsetY))}))})),P(Object(c.a)(w))}else n&&function(e){e.preventDefault();var t={x:null,y:null};"mouseup"===e.type||"click"===e.type?(t.x=e.clientX,t.y=e.clientY,S(t)):(console.log(e),console.log(e.originalEvent),t.x=e.changedTouches[0].clientX,t.y=e.changedTouches[0].clientY,S(t)),X(t),W((function(e){return!e})),N(e.target)}(e)},onDrag:function(e,t){e.preventDefault(),R(!0);var n=Object(c.a)(w);n[i].x+=t.deltaX,n[i].y+=t.deltaY,P(n)}},a.a.createElement("g",{className:"room",id:o.id,transform:"translate(".concat(o.x," ").concat(o.y,")"),onClick:function(e){C(o.id)},onKeyDown:function(e){n&&8===e.keyCode&&P((function(e){return e.filter((function(e){return e.id!==o.id}))}))},tabIndex:-1,style:{outline:0}},a.a.createElement(b,{polygon:(t=o.getPoints(),t.map((function(e){return[e.x,e.y].join(" ")}))),isSelected:n,roomId:o.id}),p(o.getPoints()).map((function(e,t){return a.a.createElement(g,{key:t,pathPoints:e,visible:n})})),o.getPoints().map((function(e,t){return a.a.createElement(y,{key:t,point:e,visible:n})})),p(o.getPoints()).map((function(e,t){return a.a.createElement(E,{key:t,pathPoints:e,visible:n})})),o.doors.map((function(e,t){return a.a.createElement(O,{key:t,door:e,i:t})})),o.components.map((function(e,t){return a.a.createElement(L,{key:t,component:e,i:t})}))))};function S(){var e=Object(r.useContext)(s),t=e.__rooms,n=e.__selectedRoom,o=e.__components,i=Object(l.a)(t,1)[0],d=(Object(l.a)(o,1)[0],Object(l.a)(n,1)[0]),p=window.innerWidth,m=window.innerHeight;return a.a.createElement("svg",{id:"plan",width:p,height:m,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},a.a.createElement(u,{width:p,height:m}),i.sort((function(e,t){var n=e.id===d;return n===(t.id===d)?0:n?1:-1})).map((function(e,t){return a.a.createElement(M,{key:e.id,isSelected:d===e.id,room:e,i:t})})),i.reduce((function(e,t,n){return e.push.apply(e,Object(c.a)(t.doors)),e}),[]).map((function(e,t){var n=i.find((function(t){return t.id===e.doorId.split(".")[0]}));return console.log("#"+e.doorId),a.a.createElement("use",{key:t,xlinkHref:"#"+e.doorId,transform:"translate(".concat(n.x," ").concat(n.y,")")})})))}n(64);var D=n(47),X=n(109);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(n,!0).forEach((function(t){Object(x.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=function(){var e=Object(r.useContext)(s),t=e.__rooms,n=e.__components,o=e.__quickMenuPosition,i=e.__quickMenuState,u=e.__selectedPathPoints,d=e.__pointer,p=e.__componentPropertiesMenu,h=e.__node,b=Object(l.a)(t,2),y=b[0],v=b[1],g=Object(l.a)(n,2),E=(g[0],g[1],Object(l.a)(o,2)),x=E[0],k=E[1],O=Object(l.a)(i,2),j=O[0],_=O[1],w=Object(l.a)(u,1)[0],P=Object(l.a)(d,1)[0],C=Object(l.a)(p,2),L=(C[0],C[1],Object(l.a)(h,2)),M=L[0];L[1];if(!M)return null;var S=function(){_(!1),k(null)},Y=function(e){var t,n=y.find((function(e){return e.id===M.id.split(".")[0]})),r={x:P.x-n.x,y:P.y-n.y},a=y.find((function(e){return e.id===n.id})).components.filter((function(t){return t.category===e.target.id})).length,o=e.target.id,i=n.id+".".concat(o,".")+a;switch(e.target.id){case"lamp":t={circuit:{name:"",number:""}};break;case"outlet":t={type:1,grounding:!0,shutter:!0,circuit:{name:"",number:""}};break;case"switch":t={way:1,pole:1,dimmer:!1,illuminated:!1,type:"switch",circuit:{name:"",number:""}}}var l={anchorPoint:r,id:i,category:o,room:n,node:M,props:t};n.components.push(l),v(Object(c.a)(y)),S()};return a.a.createElement(D.a,{id:"quickMenu",transitionDuration:{enter:0,exit:0},anchorReference:"anchorPosition",anchorPosition:null!==x?{top:x.y,left:x.x}:void 0,open:j,onClose:S},"path"===M.nodeName?a.a.createElement(X.a,{onClick:function(e){var t=Object(l.a)(w,1)[0],n=y.findIndex((function(e){return e.id===t.room})),r=P.x-y[n].x,a=P.y-y[n].y,o=f([r,a],w);m(y).forEach((function(e){Math.abs(e.absX-(o.x+y[n].x))<16&&(o.x=e.absX-y[n].x),Math.abs(e.absY-(o.y+y[n].y))<16&&(o.y=e.absY-y[n].y)}));var i=W({},o),s=W({},o);y[n].points.splice(t.i+1,0,i,s),v(Object(c.a)(y)),S()}},"add corner"):null,"path"===M.nodeName?a.a.createElement(X.a,{onClick:function(){var e=Object(l.a)(w,2),t=e[0],n=e[1],r=y.findIndex((function(e){return e.id===t.room})),a=P.x-y[r].x,o=P.y-y[r].y,i=f([a,o],w),s=y[r].id+".door."+y[r].doors.length,u={pointsIds:{a:t.id,b:n.id},doorCenter:i,doorId:s};y[r].doors.push(u),v(Object(c.a)(y)),S()}},"add door"):null,a.a.createElement(X.a,{onClick:Y,id:"outlet"},"add outlet"),a.a.createElement(X.a,{onClick:Y,id:"switch"},"add switch"),"polygon"===M.nodeName?a.a.createElement(X.a,{onClick:Y,id:"lamp"},"add lamp"):null)},N=n(107),A=n(103),q=n(70),T=n(101),R=n(104),B=n(110),H=n(102);var F=function(e){var t=e.props,n=e.handleChange,r=t.way,o=t.pole,i=t.dimmer,c=t.illuminated,l=t.type;return a.a.createElement(T.a,{container:!0,direction:"column",spacing:1},a.a.createElement(T.a,{item:!0},a.a.createElement(T.a,{container:!0,direction:"column"},a.a.createElement(T.a,{item:!0,xs:12},a.a.createElement(B.a,{exclusive:!0,"aria-label":"text alignment",value:l,onChange:n},a.a.createElement(H.a,{id:"type",value:"switch",selected:"switch"===l},"Switch"),a.a.createElement(H.a,{id:"type",value:"push",selected:"push"===l},"Push"),a.a.createElement(H.a,{id:"type",value:"inverter",selected:"inverter"===l},"Inverter"))),a.a.createElement(T.a,{item:!0,xs:12},a.a.createElement(B.a,{exclusive:!0,"aria-label":"text alignment",value:r,onChange:n},a.a.createElement(H.a,{value:1,id:"way",selected:1===r&&"switch"===l,disabled:"switch"!==l},"Single throw"),a.a.createElement(H.a,{value:2,id:"way",selected:2===r&&"switch"===l,disabled:"switch"!==l},"Double throw"))),a.a.createElement(T.a,{item:!0,xs:12},a.a.createElement(B.a,{exclusive:!0,"aria-label":"text alignment",value:o,onChange:n},a.a.createElement(H.a,{value:1,id:"pole",selected:1===o&&"switch"===l,disabled:"switch"!==l},"Single Pole"),a.a.createElement(H.a,{id:"pole",value:2,selected:2===o&&"switch"===l,disabled:"switch"!==l},"Double Pole"))),a.a.createElement(T.a,{item:!0},a.a.createElement(H.a,{id:"dimmer",value:i,selected:i,onChange:n},"Dimmer")),a.a.createElement(T.a,{item:!0},a.a.createElement(H.a,{id:"illuminated",value:c,selected:c,onChange:n},"Illuminated")))))};var U=function(e){var t=e.props,n=e.handleChange,r=t.shutter,o=t.type,i=t.grounding;return a.a.createElement(T.a,{container:!0,direction:"column",spacing:1},a.a.createElement(T.a,{item:!0},a.a.createElement(T.a,{container:!0,direction:"column"},a.a.createElement(T.a,{item:!0,xs:12},a.a.createElement(B.a,{exclusive:!0,"aria-label":"text alignment",value:o,onChange:n},a.a.createElement(H.a,{id:"type",value:1,selected:1===o},"ONE"),a.a.createElement(H.a,{id:"type",value:2,selected:2===o},"TWO"),a.a.createElement(H.a,{id:"type",value:3,selected:3===o},"THREE"),a.a.createElement(H.a,{id:"type",value:4,selected:4===o},"FOOR"),a.a.createElement(H.a,{id:"type",value:5,selected:5===o},"FIVE"))))),a.a.createElement(T.a,{item:!0},a.a.createElement(T.a,{container:!0,justify:"center",spacing:0},a.a.createElement(T.a,{item:!0,xs:6,style:{textAlign:"center"}},a.a.createElement(H.a,{id:"grounding",value:i,selected:i,onChange:n},"Grounding")),a.a.createElement(T.a,{item:!0,xs:6,style:{textAlign:"center"}},a.a.createElement(H.a,{id:"shutter",value:r,selected:r,onChange:n},"Shutter")))))};var z=function(e){return a.a.createElement("div",null,"lamp properties")},J=n(105);var K=function(e){var t=e.circuit,n=e.handleChange,o=Object(r.useState)(t.name),i=Object(l.a)(o,2),c=i[0],s=i[1];return a.a.createElement(J.a,{id:"circuit",label:"Circuit",margin:"normal",variant:"filled",onChange:function(e){s(e.target.value),n(e)},value:c?c.toUpperCase():""})};var Q=function(){var e=Object(r.useContext)(s),t=e.__componentPropertiesMenu,n=e.__rooms,o=Object(l.a)(t,2),i=o[0],u=o[1],d=Object(l.a)(n,2),p=d[0],m=d[1],f=i.open,h=i.component;if(!h)return null;var b=p.findIndex((function(e){e.id;return h.room.id})),y=p[b].components.findIndex((function(e){return e.id===h.id})),v=function(e){console.log(e);var t=e.currentTarget.value;"true"===t?t=!1:"false"===t?t=!0:isNaN(t)||(t=parseInt(t)),console.log(t);var n=e.currentTarget.id;"circuit"===n?(p[b].components[y].props[n].name=t,p[b].components[y].props[n].number=function(e,t){var n=e.reduce((function(e,t,n){return e.push.apply(e,Object(c.a)(t.components)),e}),[]).filter((function(e){return e.props.circuit.name.toLowerCase()===t.toLowerCase()}));return console.log(n.length),n.length}(p,t)):p[b].components[y].props[n]=t,m(Object(c.a)(p))};return a.a.createElement(N.a,{open:f,onClose:function(){u({})}},a.a.createElement(A.a,null,"Set component properties"),a.a.createElement(q.a,null,"id : ",h.id),a.a.createElement(K,{circuit:h.props.circuit,handleChange:v}),function(e){switch(e){case"switch":return a.a.createElement(F,{props:h.props,handleChange:v});case"outlet":return a.a.createElement(U,{props:h.props,handleChange:v});case"lamp":return a.a.createElement(z,{props:h.props,handleChange:v})}}(h.category),a.a.createElement(T.a,{item:!0},a.a.createElement(R.a,{onClick:function(){return u({open:!1})},variant:"contained",color:"primary",fullWidth:!0},"Save")))};var Z=function(){var e={__rooms:Object(r.useState)([]),__components:Object(r.useState)([]),__quickMenuPosition:Object(r.useState)(null),__quickMenuState:Object(r.useState)(!1),__selectedRoom:Object(r.useState)(null),__selectedPathPoints:Object(r.useState)(null),__pointer:Object(r.useState)(null),__doors:Object(r.useState)([]),__node:Object(r.useState)(null),__outletPropertiesMenu:Object(r.useState)({open:!1}),__switchPropertiesMenu:Object(r.useState)({open:!1}),__componentPropertiesMenu:Object(r.useState)({open:!1})};return a.a.createElement("div",{className:"App",style:{overscrollBehavior:"none"},onContextMenu:function(e){return e.preventDefault()}},a.a.createElement(s.Provider,{value:e},a.a.createElement(S,null),a.a.createElement(I,null),a.a.createElement(Q,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(Z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[58,1,2]]]);
//# sourceMappingURL=main.c5fda0ea.chunk.js.map