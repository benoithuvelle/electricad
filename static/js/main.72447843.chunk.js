(this.webpackJsonpelectricad=this.webpackJsonpelectricad||[]).push([[0],{50:function(e,t,n){e.exports=n(61)},55:function(e,t,n){},56:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(8),i=n.n(a),c=(n(55),n(5)),l=n(4),s=Object(o.createContext)(null);function u(e){var t=e.width,n=e.height,a=Object(o.useContext)(s),i=a.__selectedRoom,u=a.__rooms,d=Object(l.a)(u,2),f=d[0],p=d[1],b=i[1],y=function(e){var o=window.prompt("D\xe9nomination de la pi\xe8ce");if(""!==o&&null!==o)if(f.find((function(e){return e.id===o})))alert("Une pi\xe8ce nomm\xe9e ".concat(o," existe d\xe9j\xe0. Cr\xe9ation annul\xe9e !!!"));else{var r={id:o,x:e.clientX?e.clientX-75:t/2,y:e.clientY?e.clientY-75:n/2,points:[{x:0,y:0},{x:0,y:200},{x:200,y:200},{x:200,y:0}],getPoints:function(){var e=this;return this.points.reduce((function(t,n,r){return t[r]={x:n.x,y:n.y,absX:n.x+e.x,absY:n.y+e.y,offsetX:e.x,offsetY:e.y,i:r,room:o,id:"".concat(e.id,".").concat(r)},t}),[])},doors:[],outlets:[]};p([].concat(Object(c.a)(f),[r])),b(r.id)}};return r.a.createElement("rect",{style:{outline:"none"},tabIndex:-1,id:"background",width:t,height:n,fill:"#38a0f9",onDoubleClick:y,onClick:function(){return b(null)},onKeyDown:function(e){78===e.keyCode&&y(e)}})}var d=n(15);function f(e){return e.reduce((function(t,n,o){return t[o]=[n],o>0&&t[o-1].push(n),o===e.length-1&&t[o].push(t[0][0]),t}),[])}function p(e){return e.reduce((function(e,t,n){var o=t.getPoints();return e.push.apply(e,Object(c.a)(o)),e}),[])}var b=function(e,t){var n=Object(l.a)(t,2),o=n[0],r=n[1],a=Object(l.a)(e,2),i=a[0],c=a[1],s=(r.y-o.y)/(r.x-o.x),u=o.y-s*o.x;return 0===s?c=o.y:isFinite(s)?c=s*i+u:i=o.x,{x:i,y:c}};function y(e,t,n){var o=n.x-t.x,r=n.y-t.y,a=o*o+r*r,i=(e.x-t.x)*o+(e.y-t.y)*r,c=Math.min(1,Math.max(0,i/a));return i=(n.x-t.x)*(e.y-t.y)-(n.y-t.y)*(e.x-t.x),{point:{x:t.x+o*c,y:t.y+r*c},left:i<1,dot:i,t:c}}function m(e){var t=e.polygon;return r.a.createElement("polygon",{points:t,fill:"#ffffaa",stroke:"steelblue",strokeWidth:8})}var O=function(e){var t=e.point,n=e.visible,a=Object(o.useContext)(s).__rooms,i=Object(l.a)(a,2),u=i[0],f=i[1],b=u.findIndex((function(e){return e.id===t.room}));return n?r.a.createElement(d.DraggableCore,{handle:".corner",onDrag:function(e,n){u[b].points[t.i].x=t.x+n.deltaX,u[b].points[t.i].y=t.y+n.deltaY,f(Object(c.a)(u))},onStop:function(){p(u).forEach((function(e){e.room===t.room&&e.i===t.i||(Math.abs(t.absX-e.absX)<16&&(u[b].points[t.i].x=e.absX-t.offsetX),Math.abs(t.absY-e.absY)<16&&(u[b].points[t.i].y=e.absY-t.offsetY))})),f(Object(c.a)(u))}},r.a.createElement("g",null,r.a.createElement("circle",{className:"corner",cx:t.x,cy:t.y,r:16,fill:"white",stroke:"#38a0f9",strokeWidth:4}),r.a.createElement("text",{x:t.x,y:t.y,textAnchor:"middle",alignmentBaseline:"central",pointerEvents:"none",fill:"grey"},t.i))):null},h=n(41);function x(e){var t=e.pathPoints,n=e.visible,a=Object(o.useContext)(s),i=a.__quickMenuPosition,u=a.__quickMenuState,f=a.__selectedPathPoints,b=a.__rooms,y=a.__pointer,m=a.__pathNode,O=i[1],x=u[1],j=f[1],g=Object(l.a)(b,2),v=g[0],E=g[1],k=y[1],P=m[1],_=Object(o.useState)(!1),w=Object(l.a)(_,2),C=w[0],D=w[1],M=Object(l.a)(t,2),S=M[0],X=M[1],Y=v.findIndex((function(e){return e.id===S.room})),I=[[S.x,S.y],[X.x,X.y]],L=Object(h.a)().x((function(e){return e[0]})).y((function(e){return e[1]})),W=function(e){e.preventDefault();var n={x:null,y:null};"mouseup"===e.type?(n.x=e.clientX,n.y=e.clientY,k(n)):(console.log(e),console.log(e.originalEvent),n.x=e.changedTouches[0].clientX,n.y=e.changedTouches[0].clientY,k(n)),O(n),x((function(e){return!e})),j(t),P(e.target)};return r.a.createElement(d.DraggableCore,{handle:".segment",onDrag:function(e,t){D(!0),S.x+=t.deltaX,S.y+=t.deltaY,X.x+=t.deltaX,X.y+=t.deltaY,v[Y].points[S.i].x=S.x,v[Y].points[S.i].y=S.y,v[Y].points[X.i].x=X.x,v[Y].points[X.i].y=X.y,E(Object(c.a)(v))},onStop:function(e,n){if(C){D(!1);var o=p(v);t.forEach((function(e){o.forEach((function(t){e.id!==t.id&&(Math.abs(e.absX-t.absX)<=16&&(v[Y].points[e.i].x=t.absX-e.offsetX),Math.abs(e.absY-t.absY)<=16&&(v[Y].points[e.i].y=t.absY-e.offsetY))}))})),E(Object(c.a)(v))}else W(e)},cancel:".doorCenter, .outlet"},r.a.createElement("path",{style:n?{visibility:"visible"}:{visibility:"hidden"},d:L(I),id:S.room+"."+S.i+"."+X.i,className:"segment",strokeWidth:20,stroke:"#77cfff",strokeLinecap:"round",strokeLinejoin:"round",opacity:.8}))}var j=function(e){var t=e.pathPoints,n=e.visible,o=Object(l.a)(t,2),a=o[0],i=o[1],c=a.x-i.x,s=a.y-i.y,u=Math.round(5*Math.floor(Math.sqrt(c*c+s*s)/5));return n?r.a.createElement("text",{style:{pointerEvents:"none",fill:"#404040"}},r.a.createElement("textPath",{startOffset:"45%",xlinkHref:"#"+a.room+"."+a.i+"."+i.i},u)):null},g=n(9);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function E(e){var t=e.door,n=e.i,a=Object(o.useContext)(s).__rooms,i=Object(l.a)(a,2),u=i[0],f=i[1],p=t.pointsIds,b=t.doorCenter,m=t.doorId,O=u.find((function(e){return e.id===p.a.split(".")[0]})),h=O.getPoints().find((function(e){return e.id===p.a})),x=O.getPoints().find((function(e){return e.id===p.b})),j={x:b.x-50,y:b.y-50},E={x:b.x+50,y:b.y+50},k=y(j,h,x).point,P=y(E,h,x).point;return r.a.createElement(d.DraggableCore,{handle:".doorCenter",onDrag:function(e,t){var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(n,!0).forEach((function(t){Object(g.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},b);o.x+=t.deltaX,o.y+=t.deltaY;var r=y(o,h,x);O.doors[n].doorCenter.x=r.point.x,O.doors[n].doorCenter.y=r.point.y,f(Object(c.a)(u))}},r.a.createElement("line",{className:"doorCenter",id:m,x1:k.x,y1:k.y,x2:P.x,y2:P.y,fill:"#ffffaa",stroke:"#ffffaa",strokeWidth:8}))}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(n,!0).forEach((function(t){Object(g.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=function(e){var t=e.outlet,n=e.i,a=Object(o.useContext)(s),i=a.__rooms,u=a.__outletPropertiesMenu,f=(a.__selectedOutlet,Object(l.a)(i,2)),p=f[0],b=f[1],m=Object(l.a)(u,2),O=(m[0],m[1]),h=t.anchorPoint,x=t.pointsIds,j=(t.outletId,p.find((function(e){return e.id===x.a.split(".")[0]}))),g=j.getPoints().find((function(e){return e.id===x.a})),v=j.getPoints().find((function(e){return e.id===x.b})),E=y(h,g,v).point,k=180*Math.atan2(v.y-g.y,v.x-g.x)/Math.PI-90;return r.a.createElement(d.DraggableCore,{handle:".outlet",onDrag:function(e,t){var o=P({},h);o.x+=t.deltaX,o.y+=t.deltaY;var r=y(o,g,v);j.outlets[n].anchorPoint.x=r.point.x,j.outlets[n].anchorPoint.y=r.point.y,b(Object(c.a)(p))}},r.a.createElement("g",{className:"outlet",style:{pointerEvents:"all"},onClick:function(){O((function(e){return P({},e,{open:!0,outlet:t})}))}},">",r.a.createElement("g",null,r.a.createElement("g",{id:"1",transform:"translate(".concat(E.x," ").concat(E.y,") scale(1.75) rotate(").concat(k,")")},r.a.createElement("g",{id:"2",transform:"translate(2 2)"},r.a.createElement("path",{d:"M3.54 11.58 L3.54 0.24",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,fill:"none"}),r.a.createElement("path",{d:"M8.27 1.2 L8.27 0.25",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,fill:"none"}),r.a.createElement("path",{d:"M8.27 11.6 L8.27 10.65",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,fill:"none"}),r.a.createElement("path",{d:"M8.27 10.65 A4.72441 4.72441 0 0 1 3.55 5.93 A4.72441 4.72441 0 0 1 8.27 1.2",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,fill:"none"}),r.a.createElement("path",{d:"M3.54 5.92 L-0 5.92",id:"coucou",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,fill:"none"}),r.a.createElement("text",{style:{pointerEvents:"none",fill:"#404040"}},r.a.createElement("textPath",{xlinkHref:"#coucou"},"2fsjflksdhsdlgkfhgds")))))))};var w=function(e){var t,n=e.isSelected,a=e.room,i=e.i,u=Object(o.useContext)(s),b=u.__rooms,y=u.__selectedRoom,h=Object(l.a)(b,2),g=h[0],v=h[1],k=y[1];return r.a.createElement(d.DraggableCore,{handle:".room",cancel:".corner, .segment, .doorCenter, .outlet",disabled:!n,onStop:function(){var e=p(g);a.getPoints().forEach((function(t){e.forEach((function(e){var n=Math.abs(t.absX-e.absX),o=Math.abs(t.absY-e.absY);t.room!==e.room&&(n<=16&&(g[i].points[t.i].x=e.absX-t.offsetX),o<=16&&(g[i].points[t.i].y=e.absY-t.offsetY))}))})),v(Object(c.a)(g))},onDrag:function(e,t){e.preventDefault();var n=Object(c.a)(g);n[i].x+=t.deltaX,n[i].y+=t.deltaY,v(n)}},r.a.createElement("g",{className:"room",id:a.id,transform:"translate(".concat(a.x," ").concat(a.y,")"),onClick:function(){k(a.id)},onKeyDown:function(e){n&&8===e.keyCode&&v((function(e){return e.filter((function(e){return e.id!==a.id}))}))},tabIndex:-1,style:{outline:0}},r.a.createElement(m,{polygon:(t=a.getPoints(),t.map((function(e){return[e.x,e.y].join(" ")})))}),f(a.getPoints()).map((function(e,t){return r.a.createElement(x,{key:t,pathPoints:e,visible:n})})),a.getPoints().map((function(e,t){return r.a.createElement(O,{key:t,point:e,visible:n})})),f(a.getPoints()).map((function(e,t){return r.a.createElement(j,{key:t,pathPoints:e,visible:n})})),a.outlets.map((function(e,t){return r.a.createElement(_,{key:t,outlet:e,i:t})})),a.doors.map((function(e,t){return r.a.createElement(E,{key:t,door:e,i:t})}))))};function C(){var e=Object(o.useContext)(s),t=e.__rooms,n=e.__selectedRoom,a=Object(l.a)(t,1)[0],i=Object(l.a)(n,1)[0],d=window.innerWidth,f=window.innerHeight;return r.a.createElement("svg",{id:"plan",width:d,height:f,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r.a.createElement(u,{width:d,height:f}),a.sort((function(e,t){var n=e.id===i;return n===(t.id===i)?0:n?1:-1})).map((function(e,t){return r.a.createElement(w,{key:e.id,isSelected:i===e.id,room:e,i:t})})),a.reduce((function(e,t,n){return e.push.apply(e,Object(c.a)(t.doors)),e}),[]).map((function(e,t){var n=a.find((function(t){return t.id===e.doorId.split(".")[0]}));return console.log("#"+e.doorId),r.a.createElement("use",{key:t,xlinkHref:"#"+e.doorId,transform:"translate(".concat(n.x," ").concat(n.y,")")})})))}n(56);var D=n(89),M=n(91);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(n,!0).forEach((function(t){Object(g.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Y=function(){var e=Object(o.useContext)(s),t=e.__quickMenuPosition,n=e.__quickMenuState,a=e.__selectedPathPoints,i=e.__rooms,u=e.__pointer,d=e.__outletPropertiesMenu,f=Object(l.a)(t,2),y=f[0],m=f[1],O=Object(l.a)(n,2),h=O[0],x=O[1],j=Object(l.a)(a,1)[0],g=Object(l.a)(i,2),v=g[0],E=g[1],k=Object(l.a)(u,1)[0],P=Object(l.a)(d,2),_=(P[0],P[1]),w=function(){x(!1),m(null)};return r.a.createElement(D.a,{id:"quickMenu",transitionDuration:{enter:0,exit:0},anchorReference:"anchorPosition",anchorPosition:null!==y?{top:y.y,left:y.x}:void 0,open:h,onClose:w},r.a.createElement(M.a,{onClick:function(e){e.persist();var t=Object(l.a)(j,1)[0],n=v.findIndex((function(e){return e.id===t.room})),o=k.x-v[n].x,r=k.y-v[n].y,a=b([o,r],j);p(v).forEach((function(e){Math.abs(e.absX-(a.x+v[n].x))<16&&(a.x=e.absX-v[n].x),Math.abs(e.absY-(a.y+v[n].y))<16&&(a.y=e.absY-v[n].y)}));var i=X({},a),s=X({},a);v[n].points.splice(t.i+1,0,i,s),E(Object(c.a)(v)),w()}},"new corner"),r.a.createElement(M.a,{onClick:function(){var e=Object(l.a)(j,2),t=e[0],n=e[1],o=v.findIndex((function(e){return e.id===t.room})),r=k.x-v[o].x,a=k.y-v[o].y,i=b([r,a],j),s=v[o].id+".door."+v[o].doors.length,u={pointsIds:{a:t.id,b:n.id},doorCenter:i,doorId:s};v[o].doors.push(u),E(Object(c.a)(v)),w()}},"new door"),r.a.createElement(M.a,{onClick:function(e){var t=Object(l.a)(j,2),n=t[0],o=t[1],r=v.find((function(e){return e.id===n.room})),a=k.x-r.x,i=k.y-r.y,s={a:n.id,b:o.id},u={anchorPoint:b([a,i],j),pointsIds:s,outletId:r.id+".outlet."+r.outlets.length};r.outlets.push(u),_((function(e){return X({},e,{open:!0,outlet:u})})),E(Object(c.a)(v)),w()}},"new outlet"))},I=n(90),L=n(92),W=n(85),N=n(87),q=n(93),R=n(86);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var H=function(){var e=Object(o.useContext)(s),t=e.__outletPropertiesMenu,n=e.__rooms,a=Object(l.a)(t,2),i=a[0],c=a[1],u=Object(l.a)(n,2),d=(u[0],u[1],i.open),f=(i.outlet,Object(o.useState)({type:1,grounding:!0,shutter:!0})),p=Object(l.a)(f,2),b=p[0];return p[1],r.a.createElement(I.a,{"aria-labelledby":"simple-dialog-title",open:d,onClose:function(){c((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(n,!0).forEach((function(t){Object(g.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{open:!1})}))}},r.a.createElement(L.a,{id:"simple-dialog-title"},"Set outlet properties"),r.a.createElement(W.a,{container:!0,direction:"column",spacing:1},r.a.createElement(W.a,{item:!0},r.a.createElement(W.a,{container:!0,direction:"column"},r.a.createElement(W.a,{item:!0,xs:12},r.a.createElement(q.a,{exclusive:!0,"aria-label":"text alignment"},r.a.createElement(R.a,{selected:1===b.type},"ONE"),r.a.createElement(R.a,{selected:2===b.type},"TWO"),r.a.createElement(R.a,{selected:3===b.type},"THREE"),r.a.createElement(R.a,{selected:4===b.type},"FOOR"),r.a.createElement(R.a,{selected:5===b.type},"FIVE"))))),r.a.createElement(W.a,{item:!0},r.a.createElement(W.a,{container:!0,justify:"center",spacing:0},r.a.createElement(W.a,{item:!0,xs:6,style:{textAlign:"center"}},r.a.createElement(R.a,{selected:b.grounding},"Grounding")),r.a.createElement(W.a,{item:!0,xs:6,style:{textAlign:"center"}},r.a.createElement(R.a,{selected:b.shutter},"Shutter")))),r.a.createElement(W.a,{item:!0},r.a.createElement(N.a,{variant:"contained",color:"primary",fullWidth:!0},"Save"))))};var B=function(){var e=Object(o.useState)(null),t=Object(o.useState)(!1),n=Object(o.useState)([]),a={__quickMenuPosition:e,__quickMenuState:t,__selectedRoom:Object(o.useState)(null),__rooms:n,__selectedPathPoints:Object(o.useState)(null),__pointer:Object(o.useState)(null),__doors:Object(o.useState)([]),__pathNode:Object(o.useState)(null),__outletPropertiesMenu:Object(o.useState)({open:!1})};return r.a.createElement("div",{className:"App",style:{overscrollBehavior:"none"},onContextMenu:function(e){return e.preventDefault()}},r.a.createElement(s.Provider,{value:a},r.a.createElement(C,null),r.a.createElement(Y,null),r.a.createElement(H,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[50,1,2]]]);
//# sourceMappingURL=main.72447843.chunk.js.map