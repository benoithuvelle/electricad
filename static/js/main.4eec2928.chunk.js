(this.webpackJsonpelectricad=this.webpackJsonpelectricad||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(5),c=n.n(o),a=(n(13),n(4)),d=n(2),u=n(1),l=n(3),s=n.n(l);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(n,!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){var t=e.point,n=e.electricad,r=e.setRoom;return i.a.createElement(l.DraggableCore,{handle:".corner",onStart:function(e,t){},onDrag:function(e,i){var o=n.find((function(e){return e.id===t.id.split(".")[0]})),c=o.points.find((function(e){return e.id===t.id}));c.x=t.x+i.deltaX,c.y=t.y+i.deltaY,r(p({},o))},onStop:function(e,i){var o=n.find((function(e){return e.id===t.id.split(".")[0]})),c=o.points.find((function(e){return e.id===t.id}));n.reduce((function(e,t,n){return t.points.map((function(n){n.dx=t.x,n.dy=t.y,e.push(n)})),e}),[]).filter((function(e){return e.id!==t.id})).map((function(e){Math.abs(e.x+e.dx-(c.x+c.dx))<=16&&(c.x=e.dx+e.x-c.dx),Math.abs(e.y+e.dy-(c.y+c.dy))<=16&&(c.y=e.dy+e.y-c.dy),r(p({},o))}))}},i.a.createElement("circle",{className:"corner",id:t.id,cx:t.x,cy:t.y,r:16,fill:"white",stroke:"#38a0f9",strokeWidth:4}))};function h(e){var t=e.points.map((function(e){return[e.x,e.y].join(" ")}));return i.a.createElement("polygon",{points:t,fill:"#ffffaa",stroke:"steelblue"})}var m=n(7);function x(e){var t=e.room,n=e.path,r=e.setElectricad,o=e.electricad,c=(e.index,t.points.find((function(e){return e.id===n[0].id}))),a=t.points.find((function(e){return e.id===n[1].id})),d=Object(m.a)().x((function(e){return e.x})).y((function(e){return e.y}));return i.a.createElement(l.DraggableCore,{handle:".segment",onDrag:function(e,t){c.x=c.x+t.deltaX,a.x=a.x+t.deltaX,c.y=c.y+t.deltaY,a.y=a.y+t.deltaY,r(Object(u.a)(o))},onStop:function(e,t){o.reduce((function(e,t,n){return t.points.map((function(n){n.dx=t.x,n.dy=t.y,e.push(n)})),e}),[]).filter((function(e){return e.id!==c.id&&e.id!==a.id})).map((function(e){Math.abs(e.x+e.dx-(c.x+c.dx))<=16&&(c.x=e.dx+e.x-c.dx),Math.abs(e.y+e.dy-(c.y+c.dy))<=16&&(c.y=e.dy+e.y-c.dy),Math.abs(e.x+e.dx-(a.x+a.dx))<=16&&(a.x=e.dx+e.x-a.dx),Math.abs(e.y+e.dy-(a.y+a.dy))<=16&&(a.y=e.dy+e.y-a.dy),r(Object(u.a)(o))}))}},i.a.createElement("path",{d:d(n),id:n.id,className:"segment",strokeWidth:20,stroke:"#77cfff",opacity:.8}))}var b=function(e){var t=e.path,n=t[0],r=t[1],o=n.x-r.x,c=n.y-r.y,a=Math.floor(Math.sqrt(o*o+c*c));return i.a.createElement("text",null,i.a.createElement("textPath",{startOffset:"45%",xlinkHref:"#"+t.id},a))};function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var g=function(e){var t=e.electricad,n=e.setElectricad,o=e.setSelectedRoom,c=e.isSelected,l=e.index,f=Object(r.useState)(e.room),p=Object(a.a)(f,2),m=p[0],g=p[1];return Object(r.useEffect)((function(){console.log("room changed"),t[l]=m,n(Object(u.a)(t))}),[m]),console.log("rendering room : "+m.id),i.a.createElement(s.a,{handle:".room",position:{x:m.x,y:m.y},cancel:[".corner",".segment"],disabled:!c,onStop:function(e,n){m.x=n.x,m.y=n.y;var r=t.filter((function(e){return e.id!==m.id})).reduce((function(e,t,n){return t.points.map((function(n){n.dx=t.x,n.dy=t.y,e.push(n)})),e}),[]);m.points.map((function(e){r.map((function(t){var n=e.x+m.x,r=t.x+t.dx;Math.abs(n-r)<=30&&(e.x=r-m.x)})),r.map((function(t){var n=e.y+m.y,r=t.y+t.dy;Math.abs(n-r)<=30&&(e.y=r-m.y)}))}));g(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},m))},onDrag:function(e,t){e.preventDefault()}},i.a.createElement("g",{className:"room",id:m.id,transform:"translate(".concat(m.x," ").concat(m.y,")"),onClick:function(){o(m.id)},onKeyDown:function(e){c&&8===e.keyCode&&n(t.filter((function(e){return e.id!==m.id})))},tabIndex:-1,style:{outline:0}},i.a.createElement(h,{points:m.points}),c?m.path().map((function(e){var r;return i.a.createElement(x,(r={index:l,electricad:t,setElectricad:n,key:e.id,path:e},Object(d.a)(r,"electricad",t),Object(d.a)(r,"setRoom",g),Object(d.a)(r,"room",m),r))})):null,c?m.points.map((function(e){return i.a.createElement(y,{key:e.id,point:e,electricad:t,setRoom:g,room:m})})):null,m.path().map((function(e){return i.a.createElement(b,{key:e.id,path:e})}))))};function v(e,t,n){this.id=e,this.x=t,this.y=n,this.points=[{x:0,y:0,id:e+".corner.0"},{x:100,y:0,id:e+".corner.1"},{x:100,y:100,id:e+".corner.2"},{x:0,y:100,id:e+".corner.3"}],this.polygon=function(){return this.points.map((function(e){return[e.x,e.y].join(" ")}))},this.color="#"+(16777215*Math.random()<<0).toString(16),this.path=function(){var e=this;return this.points.reduce((function(t,n,r){return t[r]=[n],t[r].room=e.id,t[r].id=e.id+".path"+r,r>0&&t[r-1].push(n),r===e.points.length-1&&t[r].push(t[0][0]),t}),[])}}function j(e){var t=e.setElectricad,n=e.electricad,r=e.setSelectedRoom;return i.a.createElement("rect",{id:"background",width:e.width,height:e.height,fill:"#38a0f9",onDoubleClick:function(e){var i=new v("cuisine"+Math.floor(100*Math.random()),e.clientX-50,e.clientY-50);t([].concat(Object(u.a)(n),[i])),r(i.id)},onClick:function(){return r(null)}})}function E(){var e=Object(r.useState)([]),t=Object(a.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)(null),d=Object(a.a)(c,2),u=d[0],l=d[1],s=window.innerWidth,f=window.innerHeight;return i.a.createElement("svg",{width:s,height:f},i.a.createElement(j,{width:s,height:f,setElectricad:o,electricad:n,setSelectedRoom:l}),n.map((function(e,t){return i.a.createElement(g,{key:e.id,room:e,electricad:n,isSelected:u===e.id,setSelectedRoom:l,setElectricad:o,index:t})})))}n(14);var w=function(){return console.log("app rendering"),i.a.createElement("div",{className:"App",style:{overscrollBehavior:"none"}},i.a.createElement(E,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(w,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},8:function(e,t,n){e.exports=n(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.4eec2928.chunk.js.map