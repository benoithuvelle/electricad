{"version":3,"sources":["RoomContext.tsx","components/Background.tsx","utils.ts","components/Floor.tsx","components/Point.tsx","components/Segment.tsx","components/Size.tsx","components/Door.tsx","components/Outlet.tsx","components/Room.tsx","components/Plan.tsx","components/UI/QuickMenu.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["RoomContext","createContext","Background","width","height","useContext","__selectedRoom","__rooms","rooms","setRooms","setSelectedRoom","addRoom","e","id","window","prompt","find","room","alert","x","clientX","y","clientY","points","getPoints","this","reduce","acc","curr","i","absX","absY","offsetX","offsetY","doors","outlets","style","tabIndex","fill","onDoubleClick","onClick","onKeyDown","keyCode","getPath","current","push","length","getAllPoints","roomPoints","getPointCoords","clickCoords","pathPoints","a","b","m","p","isFinite","project","atob","len","dot","t","Math","min","max","point","left","Floor","polygon","stroke","strokeWidth","Point","visible","roomIndex","findIndex","handle","onDrag","dnd","deltaX","deltaY","onStop","forEach","otherPoint","abs","className","cx","cy","r","textAnchor","alignmentBaseline","pointerEvents","Segment","__quickMenuPosition","__quickMenuState","__selectedPathPoints","__pointer","__pathNode","setQuickMenuPosition","setQuickMenuState","setSelectedPathPoints","setPointer","setPathNode","useState","isDragging","setIsDragging","data","path","line","d","segmentClicked","preventDefault","coords","type","touches","pageX","pageY","prev","target","allPoints","pathPoint","cancel","visibility","strokeLinecap","strokeLinejoin","opacity","Size","dx","dy","c","round","floor","sqrt","startOffset","xlinkHref","Door","door","pointsIds","doorCenter","doorId","split","side1","side2","p1","p2","newDoorCenter","newPoint","x1","y1","x2","y2","Outlet","outlet","anchorPoint","outletId","angle","atan2","PI","newAnchorPoint","transform","Room","isSelected","disabled","newRooms","filter","el","outline","map","join","index","key","Plan","selectedRoom","innerWidth","innerHeight","xmlns","xmlnsXlink","sort","console","log","QuickMenu","quickMenuPosition","quickMenuState","selectedPathPoints","pointer","handleClose","Menu","transitionDuration","enter","exit","anchorReference","anchorPosition","top","undefined","open","onClose","MenuItem","persist","point1","point2","splice","App","CTX","__doors","overscrollBehavior","onContextMenu","Provider","value","Boolean","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.e522bd09.chunk.js","sourcesContent":["import { createContext } from 'react'\n\nexport const RoomContext = createContext(null) \n","import React, { useContext } from \"react\";\nimport { RoomContext } from './../RoomContext'\n\nexport default function Background({\n    width,\n    height,\n}: {\n    width: number;\n    height: number;\n}) {\n\n    const { __selectedRoom, __rooms } = useContext(RoomContext)\n\n    const [rooms, setRooms] = __rooms\n    const setSelectedRoom = __selectedRoom[1]\n\n    const addRoom = (e: any) => {\n        const id = window.prompt(\"Dénomination de la pièce\");\n\n        if (id === '' || id === null) return\n\n        if (rooms.find((room) => room.id === id)) {\n            alert(`Une pièce nommée ${id} existe déjà. Création annulée !!!`);\n            return;\n        }\n\n        const room = {\n            id: id,\n            x : e.clientX ? e.clientX - 75 : width/2,\n            y : e.clientY ? e.clientY - 75 : height/2,\n            points: [\n                {x : 0, y : 0},\n                {x : 0, y : 200},\n                {x : 200, y : 200},\n                {x : 200, y : 0},\n            ],\n            getPoints() {\n                return this.points.reduce((acc, curr, i) => {\n                    acc[i] = {\n                        x : curr.x,\n                        y : curr.y,\n                        absX : curr.x + this.x,\n                        absY : curr.y + this.y,\n                        offsetX : this.x,\n                        offsetY : this.y,\n                        i,\n                        room : id,\n                        id : `${this.id}.${i}`\n                    }\n                    return acc\n                }, [])\n            },\n            doors : [],\n            outlets : []\n        };\n\n        setRooms([...rooms, room]);\n        setSelectedRoom(room.id);\n    }\n\n    const keyHandler = e => {\n        if (e.keyCode === 78) {\n            addRoom(e)\n        }\n    }\n\n    return (\n        <rect\n            style={{'outline':'none'}}\n            tabIndex={-1}\n            id=\"background\"\n            width={width}\n            height={height}\n            fill=\"#38a0f9\"\n            //fill=\"white\"\n            onDoubleClick={addRoom}\n            onClick={() => setSelectedRoom(null)}\n            onKeyDown={keyHandler}\n        />\n    );\n}\n","export function getPolygon(points) {\n    return points.map((point) => [point.x, point.y].join(\" \"));\n}\n\nexport function getPath(points) {\n    return points.reduce((acc, current, i) => {\n        acc[i] = [\n            current];\n        if (i > 0) {\n            acc[i - 1].push(current)\n        }\n        if (i === points.length - 1) acc[i].push(acc[0][0]);\n        return acc;\n    }, []);\n}\n\nexport function getAllPoints(rooms) {\n    let array = rooms.reduce((acc, curr, i) => {\n        const roomPoints = curr.getPoints()\n        acc.push(...roomPoints)\n        return acc\n    }, [])\n    return array\n}\n\nexport const getPointCoords = (clickCoords, pathPoints) => {   // y = m*x + p \n    const [a, b] = pathPoints\n    let [x, y] = clickCoords\n\n    //console.log('x', x)\n    //console.log('y', y)\n\n    const m = (b.y - a.y) / (b.x - a.x)\n    //console.log('m',m)\n    const p = a.y - m*a.x\n\n    if (m === 0) {\n        y = a.y\n    } \n    else if (!isFinite(m)) {\n        x = a.x\n    } else \n        y = m*x + p\n\n    return { x, y }\n\n}\n\nexport function getY(point, pathPoints) {\n\n    const [a,b] = pathPoints\n    // y = m * x + p\n    const dx = b.x - a.x\n    const dy = b.y - a.y\n    const m = dy / dx\n    const p = a.y - m * a.x\n\n    let x\n    let y\n\n    if (m === 0) {\n        x = point.x\n        y = a.y\n    } else if (!isFinite(m)) {\n        x = a.x\n        y = point.y\n    } else {\n        x = point.x\n        y = m * point.x + p\n    }\n    return {x,y}\n}\n\nexport function closestPointToSegment(point, a, b ) {\n    //console.log(point)\n}\n\nexport function project( p, a, b ) {\n    \n    var atob = { x: b.x - a.x, y: b.y - a.y };\n    var atop = { x: p.x - a.x, y: p.y - a.y };\n    var len = atob.x * atob.x + atob.y * atob.y;\n    var dot = atop.x * atob.x + atop.y * atob.y;\n    var t = Math.min( 1, Math.max( 0, dot / len ) );\n\n    dot = ( b.x - a.x ) * ( p.y - a.y ) - ( b.y - a.y ) * ( p.x - a.x );\n    \n    return {\n        point: {\n            x: a.x + atob.x * t,\n            y: a.y + atob.y * t\n        },\n        left: dot < 1,\n        dot: dot,\n        t: t\n    };\n}","import React from \"react\";\n\nexport default function Floor({ polygon }) {\n    return <polygon\n        points={polygon}\n        fill=\"#ffffaa\"\n        stroke=\"steelblue\"\n        strokeWidth={8}\n    />;\n}\n///add memo\n","import React, { useContext } from \"react\";\nimport { RoomContext } from './../RoomContext'\nimport { DraggableCore, DraggableData } from \"react-draggable\";\nimport { getAllPoints } from \"../utils\";\n\nfunction Point({ point, visible, }) {\n\n    const { __rooms } = useContext(RoomContext)\n    const [rooms, setRooms] = __rooms\n\n    const roomIndex = rooms.findIndex(room => room.id === point.room)\n\n    if (!visible) {\n        return null;\n    }\n\n    const dragging = (e: any, dnd: DraggableData) => {\n\n        rooms[roomIndex].points[point.i].x = point.x + dnd.deltaX\n        rooms[roomIndex].points[point.i].y = point.y + dnd.deltaY\n\n        setRooms([...rooms])\n    };\n\n    const dragEnd = () => {\n\n        let allPoints = getAllPoints(rooms)\n\n\n        allPoints.forEach(otherPoint => {\n            if (otherPoint.room !== point.room || otherPoint.i !== point.i) {\n                if (Math.abs(point.absX - otherPoint.absX) < 16) {\n                    rooms[roomIndex].points[point.i].x = otherPoint.absX - point.offsetX\n                }\n                if (Math.abs(point.absY - otherPoint.absY) < 16) {\n                    rooms[roomIndex].points[point.i].y = otherPoint.absY - point.offsetY\n                }\n\n            }\n        })\n        setRooms([...rooms])\n    };\n\n    return (\n        <DraggableCore\n            handle=\".corner\"\n            onDrag={dragging}\n            onStop={dragEnd}\n        >\n            <g>\n                <circle\n                    className=\"corner\"\n                    cx={point.x}\n                    cy={point.y}\n                    r={16}\n                    fill={\"white\"}\n                    stroke={\"#38a0f9\"}\n                    strokeWidth={4}\n                />\n                <text\n                    x={point.x}\n                    y={point.y}\n                    textAnchor=\"middle\"\n                    alignmentBaseline=\"central\"\n                    pointerEvents=\"none\"\n                    fill=\"grey\"\n                >\n                    {point.i}\n                </text>\n            </g>\n        </DraggableCore>\n    );\n}\n\nexport default Point;\n","import React, { useState, useContext } from \"react\";\nimport { line } from \"d3-shape\";\nimport { DraggableCore } from \"react-draggable\";\nimport { RoomContext } from './../RoomContext'\nimport { getAllPoints } from \"../utils\";\n\nexport default function Segment({ pathPoints, visible, }) {\n\n    const { __quickMenuPosition, __quickMenuState, __selectedPathPoints, __rooms, __pointer, __pathNode } = useContext(RoomContext)\n\n    const setQuickMenuPosition = __quickMenuPosition[1]\n    const setQuickMenuState = __quickMenuState[1]\n    const setSelectedPathPoints = __selectedPathPoints[1]\n    const [rooms, setRooms] = __rooms\n    const setPointer = __pointer[1]\n    const setPathNode = __pathNode[1]\n\n    const [isDragging, setIsDragging] = useState(false)\n\n    let [a, b] = pathPoints;\n\n    const roomIndex = rooms.findIndex(room => room.id === a.room)\n\n    let data = [[a.x, a.y], [b.x, b.y]]\n\n    let path = line()\n        .x((d) => d[0])\n        .y((d) => d[1])\n\n    const dragging = (e, dnd) => {\n\n        setIsDragging(true)\n\n        a.x += dnd.deltaX\n        a.y += dnd.deltaY\n\n        b.x += dnd.deltaX\n        b.y += dnd.deltaY\n\n        rooms[roomIndex].points[a.i].x = a.x\n        rooms[roomIndex].points[a.i].y = a.y\n\n        rooms[roomIndex].points[b.i].x = b.x\n        rooms[roomIndex].points[b.i].y = b.y\n\n        setRooms([...rooms])\n    }\n\n    const dragEnd = (e, dnd) => {\n\n        if (!isDragging) {\n            segmentClicked(e)\n            return\n        }\n        setIsDragging(false)\n\n        let allPoints = getAllPoints(rooms)\n\n        pathPoints.forEach(pathPoint => {\n            allPoints.forEach(point => {\n                if (pathPoint.id !== point.id) {\n                    if (Math.abs(pathPoint.absX - point.absX) <= 16) {\n                        rooms[roomIndex].points[pathPoint.i].x = point.absX - pathPoint.offsetX\n                    }\n                    if (Math.abs(pathPoint.absY - point.absY) <= 16) {\n                        rooms[roomIndex].points[pathPoint.i].y = point.absY - pathPoint.offsetY\n                    }\n                }\n            });\n        });\n        setRooms([...rooms])\n    }\n\n    const segmentClicked = e => {\n        setPointer({ x: e.clientX, y: e.clientY })\n        e.preventDefault()\n\n        let x\n        let y\n        let coords = { x : null, y : null}\n\n        if (e.type === 'mouseup') {\n            coords.x = e.clientX\n            coords.y = e.clientY\n        } else {\n            coords.x = e.touches[0].pageX\n            coords.y = e.touches[0].pageY\n        }\n\n\n        setQuickMenuPosition(coords)\n        setQuickMenuState(prev => !prev)\n        setSelectedPathPoints(pathPoints)\n        setPathNode(e.target)\n    }\n\n    // if (!visible) {\n    //     return null;\n    // }\n\n    return (\n        <DraggableCore\n            handle=\".segment\"\n            //onStart={() => setIsDragging(true)}\n            onDrag={dragging}\n            onStop={dragEnd}\n            cancel=\".doorCenter, .outlet\"\n        >\n            <path\n                style={visible ? { visibility: \"visible\" } : { visibility: 'hidden' }}\n                d={path(data)}\n                id={a.room + '.' + a.i + '.' + b.i}\n                className=\"segment\"\n                strokeWidth={20}\n                stroke=\"#77cfff\"\n                strokeLinecap='round'\n                strokeLinejoin='round'\n                opacity={0.8}\n            //onClick={e => segmentClicked(e)}\n            />\n        </DraggableCore>\n    );\n}\n","import React from \"react\";\n\nfunction Size({pathPoints, visible}) {\n    const [a, b] = pathPoints;\n\n    var dx = a.x - b.x;\n    var dy = a.y - b.y;\n\n    var c = Math.round(Math.floor(Math.sqrt(dx * dx + dy * dy)/5)*5)\n    //console.log(c)\n\n    if (!visible) {\n        return null;\n    }\n\n    return ( // need to \n        <text style={{pointerEvents:'none', fill:'#404040'}}>\n            <textPath startOffset=\"45%\" xlinkHref={\"#\" + a.room + '.' + a.i + '.' + b.i}>\n                {c}\n            </textPath>\n        </text>\n    );\n}\n\nexport default Size;\n","import React, { useContext } from 'react'\nimport { project } from '../utils'\nimport { RoomContext } from \"../RoomContext\"\nimport { DraggableCore } from \"react-draggable\"\n\nexport default function Door({ door, i }) {\n\n    const { __rooms } = useContext(RoomContext)\n\n    const [rooms, setRooms] = __rooms\n\n    const { pointsIds, doorCenter, doorId } = door\n\n    const room = rooms.find(({ id }) => id === pointsIds.a.split('.')[0])\n\n    const a = room.getPoints().find(({ id }) => id === pointsIds.a)\n    const b = room.getPoints().find(({ id }) => id === pointsIds.b)\n\n    const side1 = { x: doorCenter.x - 50, y: doorCenter.y - 50 }\n    const side2 = { x: doorCenter.x + 50, y: doorCenter.y + 50 }\n\n    //console.log(side1)\n\n    const p1 = project(side1, a, b).point\n    const p2 = project(side2, a, b).point\n\n    const dragging = (e, dnd) => {\n\n        const newDoorCenter = { ...doorCenter }\n        newDoorCenter.x += dnd.deltaX\n        newDoorCenter.y += dnd.deltaY\n\n        const newPoint = project(newDoorCenter, a, b)\n\n        room.doors[i].doorCenter.x = newPoint.point.x\n        room.doors[i].doorCenter.y = newPoint.point.y\n        setRooms([...rooms])\n    }\n\n    return (\n\n        <DraggableCore\n            handle=\".doorCenter\"\n            onDrag={dragging}\n        >\n\n            <line\n                className='doorCenter'\n                id={doorId}\n                x1={p1.x}\n                y1={p1.y}\n                x2={p2.x}\n                y2={p2.y}\n                fill='#ffffaa'\n                stroke=\"#ffffaa\"\n                strokeWidth={8}\n            />\n\n\n        </DraggableCore>\n    )\n}\n","import React, { useContext } from 'react'\nimport { RoomContext } from '../RoomContext'\nimport { DraggableCore } from 'react-draggable'\nimport { project } from '../utils'\n\n\nfunction Outlet({ outlet, i }) {\n\n    const { __rooms } = useContext(RoomContext)\n    const [rooms, setRooms] = __rooms\n    const { anchorPoint, pointsIds, outletId } = outlet\n    const room = rooms.find(({ id }) => id === pointsIds.a.split('.')[0])\n\n    const a = room.getPoints().find(({ id }) => id === pointsIds.a)\n    const b = room.getPoints().find(({ id }) => id === pointsIds.b)\n\n    const coords = project(anchorPoint, a, b).point\n\n    var angle = (Math.atan2(b.y - a.y, b.x - a.x) * 180 / Math.PI) - 90;\n\n    const dragging = (e, dnd) => {\n\n        const newAnchorPoint = { ...anchorPoint }\n        newAnchorPoint.x += dnd.deltaX\n        newAnchorPoint.y += dnd.deltaY\n\n        const newPoint = project(newAnchorPoint, a, b)\n\n        room.outlets[i].anchorPoint.x = newPoint.point.x\n        room.outlets[i].anchorPoint.y = newPoint.point.y\n        setRooms([...rooms])\n    }\n\n\n    return (\n        <DraggableCore\n            handle=\".outlet\"\n            onDrag={dragging}\n        >\n            <g\n                className='outlet'\n                style={{ pointerEvents: 'all' }}\n            >\n                >\n                <g>\n                    <g\n                        id=\"1\"\n                        transform={`translate(${coords.x} ${coords.y}) scale(1.75) rotate(${angle})`}\n                    >\n                        <g id=\"2\"\n                            transform={`translate(2 2)`}\n\n                        >\n                            <path // ground\n                                d=\"M3.54 11.58 L3.54 0.24\"\n                                stroke='black'\n                                strokeLinecap='round'\n                                strokeLinejoin='round'\n                                strokeWidth={1.5}\n                                fill='none'\n                            />\n\n                            <path // protect left\n                                d=\"M8.27 1.2 L8.27 0.25\"\n                                stroke='black'\n                                strokeLinecap='round'\n                                strokeLinejoin='round'\n                                strokeWidth={1.5}\n                                fill='none'\n\n                            />\n                            <path // protect right\n                                d=\"M8.27 11.6 L8.27 10.65\"\n                                stroke='black'\n                                strokeLinecap='round'\n                                strokeLinejoin='round'\n                                strokeWidth={1.5}\n                                fill='none'\n\n                            />\n                            <path //arc\n                                d=\"M8.27 10.65 A4.72441 4.72441 0 0 1 3.55 5.93 A4.72441 4.72441 0 0 1 8.27 1.2\"\n                                stroke='black'\n                                strokeLinecap='round'\n                                strokeLinejoin='round'\n                                strokeWidth={1.5}\n                                fill='none'\n\n                            />\n                            <path //foot\n                                d=\"M3.54 5.92 L-0 5.92\"\n                                stroke='black'\n                                strokeLinecap='round'\n                                strokeLinejoin='round'\n                                strokeWidth={1.5}\n                                fill='none'\n\n                            />\n                        </g>\n                    </g>\n                </g>\n            </g>\n        </DraggableCore>\n    )\n}\n\nexport default Outlet\n","import React, { useContext } from \"react\";\nimport { RoomContext } from './../RoomContext'\nimport { DraggableCore, DraggableData } from \"react-draggable\";\nimport { getPath, getPolygon, getAllPoints } from \"./../utils\";\nimport Floor from \"./Floor\";\nimport Point from \"./Point\";\nimport Segment from \"./Segment\";\nimport Size from \"./Size\";\nimport Door from './Door'\nimport Outlet from './Outlet'\n\nfunction Room({\n    isSelected,\n    room,\n    i\n}: {\n    isSelected: boolean;\n    room: any;\n    i: number\n}) {\n\n    const { __rooms, __selectedRoom } = useContext(RoomContext)\n    const [rooms, setRooms] = __rooms\n    const setSelectedRoom = __selectedRoom[1]\n\n    //console.log(room.outlets)\n\n    const deleteRoom = (e: any) => {\n        if (isSelected) {\n            if (e.keyCode === 8) {\n                setRooms((rooms: any) => rooms.filter((el: any) => el.id !== room.id));\n            }\n        }\n    };\n\n    const dragging = (e: any, dnd: DraggableData) => {\n        e.preventDefault()\n\n        const newRooms = [...rooms]\n        newRooms[i].x += dnd.deltaX\n        newRooms[i].y += dnd.deltaY\n\n        setRooms(newRooms)\n    };\n\n    const dragEnded = () => {\n\n        const allPoints = getAllPoints(rooms)\n\n        room.getPoints().forEach(point => {\n            allPoints.forEach(otherPoint => {\n\n                let dx = Math.abs(point.absX - otherPoint.absX)\n                let dy = Math.abs(point.absY - otherPoint.absY)\n\n                if (point.room !== otherPoint.room) {\n                    if (dx <= 16) {\n                        rooms[i].points[point.i].x = otherPoint.absX - point.offsetX\n                    }\n                    if (dy <= 16) {\n                        rooms[i].points[point.i].y = otherPoint.absY - point.offsetY\n                    }\n                }\n            })\n        })\n        setRooms([...rooms])\n    }\n\n    return (\n        <DraggableCore\n            handle=\".room\"\n            cancel=\".corner, .segment, .doorCenter, .outlet\"\n            disabled={!isSelected}\n            onStop={dragEnded}\n            onDrag={dragging}\n        >\n            <g\n                className={\"room\"}\n                id={room.id}\n                transform={`translate(${room.x} ${room.y})`}\n                onClick={() => {\n                    setSelectedRoom(room.id);\n                }}\n                onKeyDown={deleteRoom}\n                tabIndex={-1}\n                style={{ outline: 0 }}\n            >\n                <Floor\n                    polygon={getPolygon(room.getPoints())}\n                />\n\n                {\n                    getPath(room.getPoints()).map((pathPoints, index) => (\n                        <Segment\n                            key={index}\n                            pathPoints={pathPoints}\n                            visible={isSelected}\n                        />\n                    ))\n                }\n\n                {\n                    room.getPoints().map((point, index) => (\n                        <Point\n                            key={index}\n                            point={point}\n                            visible={isSelected}\n                        />\n                    ))\n                }\n                {\n                    getPath(room.getPoints()).map((pathPoints, index) => (\n                        <Size\n                            key={index}\n                            pathPoints={pathPoints}\n                            visible={isSelected}\n                        />\n                    ))\n                }\n                {\n                    room.outlets.map((outlet, i) => (\n                        <Outlet\n                            key={i}\n                            outlet={outlet}\n                            i={i}\n                        />\n                    ))\n                }\n                {\n                    room.doors.map((door, i) => (\n                        <Door\n                            key={i}\n                            door={door}\n                            i={i}\n                        />\n                    ))\n                }\n            </g>\n        </DraggableCore>\n    );\n}\n\nexport default Room;\n\n","import React, { useContext } from \"react\";\nimport Background from \"./Background\";\nimport Room from \"./Room\";\nimport { RoomContext } from \"../RoomContext\";\n\nexport default function Plan() {\n\n    const { __rooms, __selectedRoom } = useContext(RoomContext)\n\n    const [rooms] = __rooms;\n    const [selectedRoom] = __selectedRoom;\n    const width = window.innerWidth;\n    const height = window.innerHeight;\n\n    return (\n        <svg\n            id='plan'\n            width={width}\n            height={height}\n            xmlns=\"http://www.w3.org/2000/svg\"\n            xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n        >\n\n            <Background\n                width={width}\n                height={height}\n            />\n\n            {\n                rooms\n                    .sort((a, b) => {\n                        const c = (a.id === selectedRoom)\n                        const d = (b.id === selectedRoom)\n                        return (c === d) ? 0 : c ? 1 : - 1\n                    })\n                    .map((room, i) => {\n                        return (\n                            <Room\n                                key={room.id}\n                                isSelected={selectedRoom === room.id ? true : false}\n                                room={room}\n                                i={i}\n                            />\n                        );\n                    })\n            }\n\n            {\n                rooms.reduce((acc, curr, i) => {\n                    acc.push(...curr.doors)\n                    return acc\n                },[]).map((door,i) => {\n                    const room = rooms.find(({id}) => id === door.doorId.split('.')[0])\n                    console.log('#' + door.doorId)\n\n                   // if (selectedRoom !== room.id) {\n                        return (\n                            <use\n                            key={i}\n                            xlinkHref={'#' + door.doorId}\n                            transform={`translate(${room.x} ${room.y})`}\n                        /> \n                        )\n                    //} else return\n                })\n            }\n\n\n\n\n\n        </svg>\n    );\n}\n","import React, { useContext } from 'react'\nimport { Menu, MenuItem } from '@material-ui/core'\nimport { getPointCoords, getAllPoints } from './../../utils'\nimport { RoomContext } from './../../RoomContext'\n\nconst QuickMenu = () => {\n\n    const {\n        __quickMenuPosition,\n        __quickMenuState,\n        __selectedPathPoints,\n        __rooms,\n        __pointer,\n    } = useContext(RoomContext)\n\n    const [quickMenuPosition, setQuickMenuPosition] = __quickMenuPosition\n    const [quickMenuState, setQuickMenuState] = __quickMenuState\n    const [selectedPathPoints] = __selectedPathPoints\n    const [rooms, setRooms] = __rooms\n    const [pointer] = __pointer\n\n    ////console.log(pointer)\n\n    const handleClose = () => {\n        setQuickMenuState(false)\n        setQuickMenuPosition(null)\n    }\n\n    const addCorner = e => {\n        e.persist()\n        //console.log(e)\n\n\n        const [a] = selectedPathPoints\n        const roomIndex = rooms.findIndex(room => room.id === a.room)\n\n        const x = pointer.x - rooms[roomIndex].x\n        const y = pointer.y - rooms[roomIndex].y\n\n        const newPoint = getPointCoords([x, y], selectedPathPoints)\n\n        getAllPoints(rooms).forEach(point => {\n            //console.log(newPoint)\n            if (Math.abs(point.absX - (newPoint.x + rooms[roomIndex].x)) < 16) {\n                newPoint.x = point.absX - rooms[roomIndex].x\n            }\n            if (Math.abs(point.absY - (newPoint.y + rooms[roomIndex].y)) < 16) {\n                newPoint.y = point.absY - rooms[roomIndex].y\n            }\n        })\n\n        const point1 = { ...newPoint }\n        const point2 = { ...newPoint }\n\n        rooms[roomIndex].points.splice(a.i + 1, 0, point1, point2)\n        setRooms([...rooms])\n\n        handleClose()\n    }\n\n    const addDoor = () => {\n\n        const [a, b] = selectedPathPoints\n\n        const roomIndex = rooms.findIndex(room => room.id === a.room)\n\n        const x = pointer.x - rooms[roomIndex].x\n        const y = pointer.y - rooms[roomIndex].y\n\n        const doorCenter = getPointCoords([x, y], selectedPathPoints)\n        const doorId = rooms[roomIndex].id + '.door.' + rooms[roomIndex].doors.length\n\n\n        const pointsIds = { a: a.id, b: b.id }\n\n        const door = { pointsIds, doorCenter, doorId }\n\n        rooms[roomIndex].doors.push(door)\n\n        setRooms([...rooms])\n\n        handleClose()\n\n    }\n\n    const addOutlet = e => {\n        const [a, b] = selectedPathPoints\n\n        //const roomIndex = rooms.findIndex(room => room.id === a.room)\n        const room = rooms.find(({id}) => id === a.room)\n\n        const x = pointer.x - room.x\n        const y = pointer.y - room.y\n\n        const pointsIds = { a: a.id, b: b.id }\n        const anchorPoint = getPointCoords([x, y], selectedPathPoints)\n        const outletId = room.id + '.outlet.' + room.outlets.length\n\n\n        const outlet = { anchorPoint, pointsIds, outletId }\n\n        room.outlets.push(outlet)\n        setRooms([...rooms])\n        handleClose()\n\n\n    }\n\n\n    return (\n        <Menu\n            id=\"quickMenu\"\n            transitionDuration={{ enter: 0, exit: 0 }}\n            anchorReference=\"anchorPosition\"\n            anchorPosition={\n                quickMenuPosition !== null\n                    ? { top: quickMenuPosition.y, left: quickMenuPosition.x }\n                    : undefined\n            }\n            open={quickMenuState}\n            onClose={handleClose}\n        >\n            <MenuItem onClick={addCorner}>new corner</MenuItem>\n            <MenuItem onClick={addDoor}>new door</MenuItem>\n            <MenuItem onClick={addOutlet}>new outlet</MenuItem>\n        </Menu>\n    )\n}\n\nexport default QuickMenu\n","import React, { useState } from \"react\";\nimport Plan from \"./components/Plan\";\nimport \"./App.css\";\nimport QuickMenu from './components/UI/QuickMenu'\nimport { RoomContext } from './RoomContext'\n\nfunction App() {\n\n    const __quickMenuPosition = useState(null)\n    const __quickMenuState = useState(false)\n    const __rooms = useState([])\n    const __selectedRoom = useState(null)\n    const __selectedPathPoints = useState(null)\n    const __pointer = useState(null)\n    const __doors = useState([])\n    const __pathNode = useState(null)\n\n    const CTX = {\n        __quickMenuPosition,\n        __quickMenuState,\n        __selectedRoom,\n        __rooms,\n        __selectedPathPoints,\n        __pointer,\n        __doors,\n        __pathNode\n    }\n    \n\n    return (\n        <div\n            className=\"App\"\n            style={{ overscrollBehavior: \"none\" }}\n            onContextMenu={e => e.preventDefault()}\n        >\n            <RoomContext.Provider value={CTX}>\n                <Plan/>\n                <QuickMenu/>\n            </RoomContext.Provider>\n        </div>\n    );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n    window.location.hostname === \"localhost\" ||\n        // [::1] is the IPv6 localhost address.\n        window.location.hostname === \"[::1]\" ||\n        // 127.0.0.1/8 is considered localhost for IPv4.\n        window.location.hostname.match(\n            /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n        ),\n);\n\ninterface Config {\n    onSuccess?: (registration: ServiceWorkerRegistration) => void;\n    onUpdate?: (registration: ServiceWorkerRegistration) => void;\n}\n\nexport function register(config?: Config) {\n    if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n        // The URL constructor is available in all browsers that support SW.\n        const publicUrl = new URL(\n            (process as {env: {[key: string]: string}}).env.PUBLIC_URL,\n            window.location.href,\n        );\n        if (publicUrl.origin !== window.location.origin) {\n            // Our service worker won't work if PUBLIC_URL is on a different origin\n            // from what our page is served on. This might happen if a CDN is used to\n            // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n            return;\n        }\n\n        window.addEventListener(\"load\", () => {\n            const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n            if (isLocalhost) {\n                // This is running on localhost. Let's check if a service worker still exists or not.\n                checkValidServiceWorker(swUrl, config);\n\n                // Add some additional logging to localhost, pointing developers to the\n                // service worker/PWA documentation.\n                navigator.serviceWorker.ready.then(() => {\n                    console.log(\n                        \"This web app is being served cache-first by a service \" +\n                            \"worker. To learn more, visit http://bit.ly/CRA-PWA\",\n                    );\n                });\n            } else {\n                // Is not localhost. Just register service worker\n                registerValidSW(swUrl, config);\n            }\n        });\n    }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n    navigator.serviceWorker\n        .register(swUrl)\n        .then((registration) => {\n            registration.onupdatefound = () => {\n                const installingWorker = registration.installing;\n                if (installingWorker == null) {\n                    return;\n                }\n                installingWorker.onstatechange = () => {\n                    if (installingWorker.state === \"installed\") {\n                        if (navigator.serviceWorker.controller) {\n                            // At this point, the updated precached content has been fetched,\n                            // but the previous service worker will still serve the older\n                            // content until all client tabs are closed.\n                            console.log(\n                                \"New content is available and will be used when all \" +\n                                    \"tabs for this page are closed. See http://bit.ly/CRA-PWA.\",\n                            );\n\n                            // Execute callback\n                            if (config && config.onUpdate) {\n                                config.onUpdate(registration);\n                            }\n                        } else {\n                            // At this point, everything has been precached.\n                            // It's the perfect time to display a\n                            // \"Content is cached for offline use.\" message.\n                            console.log(\"Content is cached for offline use.\");\n\n                            // Execute callback\n                            if (config && config.onSuccess) {\n                                config.onSuccess(registration);\n                            }\n                        }\n                    }\n                };\n            };\n        })\n        .catch((error) => {\n            console.error(\"Error during service worker registration:\", error);\n        });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n    // Check if the service worker can be found. If it can't reload the page.\n    fetch(swUrl)\n        .then((response) => {\n            // Ensure service worker exists, and that we really are getting a JS file.\n            const contentType = response.headers.get(\"content-type\");\n            if (\n                response.status === 404 ||\n                (contentType != null && contentType.indexOf(\"javascript\") === -1)\n            ) {\n                // No service worker found. Probably a different app. Reload the page.\n                navigator.serviceWorker.ready.then((registration) => {\n                    registration.unregister().then(() => {\n                        window.location.reload();\n                    });\n                });\n            } else {\n                // Service worker found. Proceed as normal.\n                registerValidSW(swUrl, config);\n            }\n        })\n        .catch(() => {\n            console.log(\n                \"No internet connection found. App is running in offline mode.\",\n            );\n        });\n}\n\nexport function unregister() {\n    if (\"serviceWorker\" in navigator) {\n        navigator.serviceWorker.ready.then((registration) => {\n            registration.unregister();\n        });\n    }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}